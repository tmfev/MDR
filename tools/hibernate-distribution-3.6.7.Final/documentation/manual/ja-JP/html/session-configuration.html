<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">第3章 設定</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="HIBERNATE - Relational Persistence for Idiomatic Java"/><link rel="up" href="index.html" title="HIBERNATE - Relational Persistence for Idiomatic Java"/><link rel="prev" href="architecture.html" title="第2章 アーキテクチャ"/><link rel="next" href="persistent-classes.html" title="第4章 永続クラス"/><link rel="copyright" href="Legal_Notice.html" title="Legal Notice"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="architecture.html"><strong>前のページ</strong></a></li><li class="next"><a accesskey="n" href="persistent-classes.html"><strong>次のページ</strong></a></li></ul><div class="chapter" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="session-configuration"/>第3章 設定</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="session-configuration.html#configuration-programmatic">3.1. プログラム上の設定</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-sessionfactory">3.2. SessionFactory を取得する</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-hibernatejdbc">3.3. JDBC コネクション</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-optional">3.4. オプション設定プロパティ</a></span></dt><dd><dl><dt><span class="section"><a href="session-configuration.html#configuration-optional-dialects">3.4.1. SQL 方言（Dialect）</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-optional-outerjoin">3.4.2. 外部結合フェッチ</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-optional-binarystreams">3.4.3. バイナリストリーム</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-optional-cacheprovider">3.4.4. ニ次キャッシュとクエリキャッシュ</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-optional-querysubstitution">3.4.5. クエリ言語の置き換え</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-optional-statistics">3.4.6. Hibernate 統計</a></span></dt></dl></dd><dt><span class="section"><a href="session-configuration.html#configuration-logging">3.5. ロギング</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-namingstrategy">3.6. NamingStrategy を選択</a></span></dt><dt><span class="section"><a href="session-configuration.html#d0e3252">3.7. Implementing a PersisterClassProvider</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-xmlconfig">3.8. XML 設定ファイル</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-j2ee">3.9. Java EE Application Server integration</a></span></dt><dd><dl><dt><span class="section"><a href="session-configuration.html#configuration-optional-transactionstrategy">3.9.1. トランザクション戦略設定</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-optional-jndi">3.9.2. SessionFactory の JNDI への登録</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-j2ee-currentsession">3.9.3. JTA による現在のセッションコンテキストマネージメント</a></span></dt><dt><span class="section"><a href="session-configuration.html#configuration-j2ee-jmx">3.9.4. JMX デプロイメント</a></span></dt></dl></dd></dl></div><p>Hibernate は様々な環境で動作するようにデザインされているため、非常に多くの設定要素があります。幸いなことに、 Hibernate は、公開されているパッケージの <code class="literal">etc/</code> フォルダの <code class="literal">hibernate.properties</code> に、ほとんどの設定要素の適切なデフォルト値が記述されています。この <code class="literal">hibernate.properties</code> をクラスパスに設定し、設定要素をカスタマイズするだけです。</p><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-programmatic"/>3.1. プログラム上の設定</h2></div></div></div><p><code class="classname">org.hibernate.cfg.Configuration</code> のインスタンスは、 Java の型と SQL データベースのマッピング情報をすべて持っています。 <code class="literal">Configuration</code> は、（不変の） <code class="interfacename">SessionFactory</code> を生成するときに使用します。複数の XML マッピングファイルを変換し、マッピング情報にします。</p><p>通常、 <code class="classname">org.hibernate.cfg.Configuration</code> インスタンスは、特定の XML マッピングファイルによって直接初期化されます。もし、マッピングファイルがクラスパスに設定されている場合、次のメソッドを使ってください。 <code class="literal">addResource()</code> :</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_plain">&nbsp;cfg&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addResource</span><span class="java_separator">(</span><span class="java_literal">&quot;Item.hbm.xml&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addResource</span><span class="java_separator">(</span><span class="java_literal">&quot;Bid.hbm.xml&quot;</span><span class="java_separator">);</span></pre><p>代替案 (こちらのほうが良いときもあります) としてマッピングクラスを指定する方法もあります。 Hibernate に、マッピングファイルを 見つけさせてください：</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_plain">&nbsp;cfg&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addClass</span><span class="java_separator">(</span><span class="java_plain">org</span><span class="java_separator">.</span><span class="java_plain">hibernate</span><span class="java_separator">.</span><span class="java_plain">auction</span><span class="java_separator">.</span><span class="java_type">Item</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addClass</span><span class="java_separator">(</span><span class="java_plain">org</span><span class="java_separator">.</span><span class="java_plain">hibernate</span><span class="java_separator">.</span><span class="java_plain">auction</span><span class="java_separator">.</span><span class="java_type">Bid</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">);</span></pre><p>Hibernate は、クラスパスにある以下のような名前のマッピングファイルを見つけます。 <code class="filename">/org/hibernate/auction/Item.hbm.xml</code> 、 <code class="filename">/org/hibernate/auction/Bid.hbm.xml</code> 。この方法だと、ハードコーディングされたファイル名を排除できます。</p><p><code class="classname">org.hibernate.cfg.Configuration</code> は、設定プロパティを指定することもできます：</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_plain">&nbsp;cfg&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addClass</span><span class="java_separator">(</span><span class="java_plain">org</span><span class="java_separator">.</span><span class="java_plain">hibernate</span><span class="java_separator">.</span><span class="java_plain">auction</span><span class="java_separator">.</span><span class="java_type">Item</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addClass</span><span class="java_separator">(</span><span class="java_plain">org</span><span class="java_separator">.</span><span class="java_plain">hibernate</span><span class="java_separator">.</span><span class="java_plain">auction</span><span class="java_separator">.</span><span class="java_type">Bid</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setProperty</span><span class="java_separator">(</span><span class="java_literal">&quot;hibernate.dialect&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;org.hibernate.dialect.MySQLInnoDBDialect&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setProperty</span><span class="java_separator">(</span><span class="java_literal">&quot;hibernate.connection.datasource&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;java:comp/env/jdbc/test&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setProperty</span><span class="java_separator">(</span><span class="java_literal">&quot;hibernate.order_updates&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;true&quot;</span><span class="java_separator">);</span></pre><p>Hibernate に設定プロパティを渡す方法は1つではありません。さまざまなオプションを用意しています：</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li><p><code class="literal">java.util.Properties</code> インスタンスを <code class="literal">Configuration.setProperties()</code> に渡します。</p></li><li><p><code class="literal">hibernate.properties</code> をクラスパスのルートディレクトリに置きます。</p></li><li><p><code class="literal">System</code> プロパティが <code class="literal">java -Dproperty=value</code> を使うように設定します。</p></li><li><p><code class="literal">&lt;property&gt;</code> 要素を <code class="filename">hibernate.cfg.xml</code> （後述）に設定します。</p></li></ol></div><p>If you want to get started quickly<code class="filename">hibernate.properties</code> is the easiest approach.</p><p><code class="classname">org.hibernate.cfg.Configuration</code> は、起動時にだけあるオブジェクトであり、一度 <code class="literal">SessionFactory</code> を生成した後は、破棄されることを意図しています。</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-sessionfactory"/>3.2. SessionFactory を取得する</h2></div></div></div><p>When all mappings have been parsed by the <code class="classname">org.hibernate.cfg.Configuration</code>, the application must obtain a factory for <code class="interfacename">org.hibernate.Session</code> instances. This factory is intended to be shared by all application threads:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">SessionFactory</span><!-- <br/> --><span class="java_plain">&nbsp;sessions&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;cfg</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildSessionFactory</span><!-- <br/> --><span class="java_separator">();</span></pre><p>Hibernate does allow your application to instantiate more than one <code class="interfacename">org.hibernate.SessionFactory</code>. This is useful if you are using more than one database.</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-hibernatejdbc"/>3.3. JDBC コネクション</h2></div></div></div><p>通常、開発者は <code class="interfacename">org.hibernate.SessionFactory</code> を生成し、 SessionFactory で JDBC コネクションをプーリングしたいと考えます。そのアプローチを採用する場合、単純に <code class="interfacename">org.hibernate.Session</code> をオープンしてください：</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Session</span><!-- <br/> --><span class="java_plain">&nbsp;session&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;sessions</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">openSession</span><!-- <br/> --><span class="java_separator">();</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;open&nbsp;a&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Session</span></pre><p>これだけで、プーリングした JDBC コネクションを使って目的のデータベースにアクセスすることができます。</p><p>そのためには、 JDBC コネクションのプロパティを Hibernate に設定する必要があります。すべての Hibernate プロパティ名とセマンティクスは <code class="classname">org.hibernate.cfg.Environment</code> クラスに定義されています。この設定は JDBC コネクション設定の中で一番重要なものです。</p><p>もし、以下のプロパティを設定すると、 Hibernate はコネクションを取得するために（プールも） <code class="classname">java.sql.DriverManager</code> を使います:</p><div class="table"><a id="d0e1725"/><p class="title"><b>表3.1 Hibernate JDBC プロパティ</b></p><div class="table-contents"><table summary="Hibernate JDBC プロパティ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>プロパティ名</th><th>意味</th></tr></thead><tbody><tr><td><span class="property">hibernate.connection.driver_class</span></td><td><span class="emphasis"><em>JDBC driver class</em></span></td></tr><tr><td><span class="property">hibernate.connection.url</span></td><td><span class="emphasis"><em>JDBC URL</em></span></td></tr><tr><td><span class="property">hibernate.connection.username</span></td><td><span class="emphasis"><em>データベースのユーザー</em></span></td></tr><tr><td><span class="property">hibernate.connection.password</span></td><td><span class="emphasis"><em>データベースユーザーパスワード</em></span></td></tr><tr><td><span class="property">hibernate.connection.pool_size</span></td><td><span class="emphasis"><em>maximum number of pooled connections</em></span></td></tr></tbody></table></div></div><br class="table-break"/><p>Hibernate のコネクションプールアルゴリズムは非常に初歩的なものです。これはすぐに始められるようにと用意されたもので、 <span class="emphasis"><em>製品として使用することを意図していません</em></span> 。また、パフォーマンスのテストのためのものでもありません。最高のパフォーマンスと安定性を持ったプールを実現したければ、サードパーティのツールをお勧めします。 <code class="literal">hibernate.connection.pool_size</code> プロパティと適切なコネクションプールの設定を置き換えてください。これにより Hibernate のインターナルプールを無効にします。例えば次のように C3P0 を使います。</p><p>C3P0 はオープンソース JDBC コネクションプールで、 Hibernate の <code class="literal">lib</code> ディレクトリにあります。もし、 <code class="literal">hibernate.c3p0.*</code> プロパティをセットすれば、 Hibernate は、 <code class="literal">C3P0ConnectionProvider</code> を使います。もし Proxool を使いたい場合は、 <code class="literal">hibernate.properties</code> パッケージを参照したり、 Hibernate の Web サイトでより多くの情報を取得してください。</p><p>C3P0 用の <code class="literal">hibernate.properties</code> ファイルを例として示します：</p><pre class="programlisting">hibernate.connection.driver_class = org.postgresql.Driver
hibernate.connection.url = jdbc:postgresql://localhost/mydatabase
hibernate.connection.username = myuser
hibernate.connection.password = secret
hibernate.c3p0.min_size=5
hibernate.c3p0.max_size=20
hibernate.c3p0.timeout=1800
hibernate.c3p0.max_statements=50
hibernate.dialect = org.hibernate.dialect.PostgreSQLDialect</pre><p>アプリケーションサーバー上で使う場合は、 Hibernate を設定し、アプリケーションサーバーからコネクションを取得するようにしてください。 <code class="interfacename">javax.sql.Datasource</code> を JNDI に登録します。そしてプロパティを以下のように設定してください:</p><div class="table"><a id="d0e1807"/><p class="title"><b>表3.2 Hibernate データソースプロパティ</b></p><div class="table-contents"><table summary="Hibernate データソースプロパティ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>プロパティ名</th><th>意味</th></tr></thead><tbody><tr><td><span class="property">hibernate.connection.datasource</span></td><td><span class="emphasis"><em>データソースの JNDI 名</em></span></td></tr><tr><td><span class="property">hibernate.jndi.url</span></td><td><span class="emphasis"><em>JNDI プロバイダの URL</em></span> (オプション)</td></tr><tr><td><span class="property">hibernate.jndi.class</span></td><td><span class="emphasis"><em>JNDI のクラス <code class="literal">InitialContextFactory</code></em></span> (オプション)</td></tr><tr><td><span class="property">hibernate.connection.username</span></td><td><span class="emphasis"><em>データベースユーザ</em></span> (オプション)</td></tr><tr><td><span class="property">hibernate.connection.password</span></td><td><span class="emphasis"><em>データベースユーザのパスワード</em></span> (オプション)</td></tr></tbody></table></div></div><br class="table-break"/><p>アプリケーションサーバーから提供された JNDI データソースを使う <code class="filename">hibernate.properties</code> ファイルの例を示します：</p><pre class="programlisting">hibernate.connection.datasource = java:/comp/env/jdbc/test
hibernate.transaction.factory_class = \
    org.hibernate.transaction.JTATransactionFactory
hibernate.transaction.manager_lookup_class = \
    org.hibernate.transaction.JBossTransactionManagerLookup
hibernate.dialect = org.hibernate.dialect.PostgreSQLDialect</pre><p>JNDI データソースから取得した JDBC コネクションは、アプリケーションサーバーのコンテナ管理トランザクションに自動的に参加します。</p><p>任意のコネクションプロパティは、追加された "<code class="literal">hibernate.connnection</code>" プロパティ名によって与えられます。例えば、 <span class="property">charSet</span> を設定したい場合は、 <span class="property">hibernate.connection.charSet</span> を使います。</p><p>JDBC コネクションを取得する戦略を持つ独自のプラグインを定義する場合は、 <code class="interfacename">org.hibernate.connection.ConnectionProvider</code> インターフェースを実装してください。そして、実装クラスを <span class="property">hibernate.connection.provider_class</span> に設定してください。</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-optional"/>3.4. オプション設定プロパティ</h2></div></div></div><p>これらのプロパティはランタイムに Hibernate の挙動を制御するものです。これらのプロパティはすべて妥当なデフォルト値があり、任意で設定します。</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p><span class="emphasis"><em>Some of these properties are "system-level" only.</em></span> System-level properties can be set only via <code class="literal">java -Dproperty=value</code> or <code class="filename">hibernate.properties</code>. They <span class="emphasis"><em>cannot</em></span> be set by the other techniques described above.</p></div><div class="table"><a id="configuration-optional-properties"/><p class="title"><b>表3.3 Hibernate 設定プロパティ</b></p><div class="table-contents"><table summary="Hibernate 設定プロパティ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>プロパティ名</th><th>意味</th></tr></thead><tbody><tr><td><span class="property">hibernate.dialect</span></td><td>Hibernate のクラス名 <code class="classname">org.hibernate.dialect.Dialect</code> が入ります。これはリレーショナルデータベースごとに最適化された SQL を生成します。 <p><span class="strong"><strong>例</strong></span><code class="literal">full.classname.of.Dialect</code> </p> <p>In most cases Hibernate will actually be able to choose the correct <code class="classname">org.hibernate.dialect.Dialect</code> implementation based on the <code class="literal">JDBC metadata</code> returned by the JDBC driver. </p></td></tr><tr><td><span class="property">hibernate.show_sql</span></td><td>発行されたすべての SQL をコンソールに出力します。これはログカテゴリの <code class="literal">org.hibernate.SQL</code> に <code class="literal">debug</code> を設定する方法の代替手段です。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.format_sql</span></td><td>ログとコンソールの SQL を整形して表示します。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.default_schema</span></td><td>生成される SQL 文のテーブルに設定するスキーマ/テーブルスペースです。 <p><span class="strong"><strong>例.</strong></span><code class="literal">SCHEMA_NAME</code> </p></td></tr><tr><td><span class="property">hibernate.default_catalog</span></td><td>生成される SQL 文のテーブルに設定するカタログです。 <p><span class="strong"><strong>例</strong></span><code class="literal">CATALOG_NAME</code> </p></td></tr><tr><td><span class="property">hibernate.session_factory_name</span></td><td><code class="interfacename">org.hibernate.SessionFactory</code> は生成後、この名前で JNDI に自動的に登録されます。 <p><span class="strong"><strong>例</strong></span><code class="literal">jndi/composite/name</code> </p></td></tr><tr><td><span class="property">hibernate.max_fetch_depth</span></td><td>外部結合フェッチの最大深度を設定します。結合する関連は対一関連のみ（一対一、多対一）です。 <code class="literal">0</code> を指定すると外部結合フェッチは無効になります。 <p><span class="strong"><strong>例：</strong></span> 推奨する値は <code class="literal">0</code> から <code class="literal">3</code> の間です。 </p></td></tr><tr><td><span class="property">hibernate.default_batch_fetch_size</span></td><td>関連フェッチのデフォルト Hibernate バッチサイズを指定します。 <p><span class="strong"><strong>例：</strong></span> 推奨する値は <code class="literal">4</code> , <code class="literal">8</code> , <code class="literal">16</code> です。 </p></td></tr><tr><td><span class="property">hibernate.default_entity_mode</span></td><td>Sets a default mode for entity representation for all sessions opened from this <code class="literal">SessionFactory</code> <p><code class="literal">dynamic-map</code>, <code class="literal">dom4j</code>, <code class="literal">pojo</code> </p></td></tr><tr><td><span class="property">hibernate.order_updates</span></td><td>項目が更新されたときに、別の SQL で主キーを更新することを強制します。この場合、同時実行可能なシステムでは、まれにデッドロックが発生する可能性があります。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.generate_statistics</span></td><td>有効の場合、 Hibernate はパフォーマンスチューニングに有効な統計情報を収集します。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.use_identifier_rollback</span></td><td>有効の場合、オブジェクトが削除されたときに識別子プロパティをリセットし、デフォルト値にしたものを生成します。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.use_sql_comments</span></td><td>有効の場合、 SQL 内にコメントを生成します。これはデバックを容易にします。デフォルトの値は <code class="literal">false</code> です。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.id.new_generator_mappings</span></td><td>Setting is relevant when using <code class="classname">@GeneratedValue</code>. It indicates whether or not the new <code class="classname">IdentifierGenerator</code> implementations are used for <code class="classname">javax.persistence.GenerationType.AUTO</code>, <code class="classname">javax.persistence.GenerationType.TABLE</code> and <code class="classname">javax.persistence.GenerationType.SEQUENCE</code>. Default to <code class="literal">false</code> to keep backward compatibility. <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>We recommend all new projects which make use of to use <code class="classname">@GeneratedValue</code> to also set <code class="code">hibernate.id.new_generator_mappings=true</code> as the new generators are more efficient and closer to the JPA 2 specification semantic. However they are not backward compatible with existing databases (if a sequence or a table is used for id generation).</p></div><div class="table"><a id="configuration-jdbc-properties"/><p class="title"><b>表3.4 Hibernate JDBC とコネクションプロパティ</b></p><div class="table-contents"><table summary="Hibernate JDBC とコネクションプロパティ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>プロパティ名</th><th>意味</th></tr></thead><tbody><tr><td><span class="property">hibernate.jdbc.fetch_size</span></td><td>値が0でない場合、 JDBC フェッチサイズを決定します ( <code class="literal">Statement.setFetchSize()</code> を呼びます)。</td></tr><tr><td><span class="property">hibernate.jdbc.batch_size</span></td><td>値が0でない場合、 Hibernate が JDBC2 バッチ更新を使用します。 <p><span class="strong"><strong>例：</strong></span> 推奨する値は <code class="literal">5</code> から <code class="literal">30</code> の間です。 </p></td></tr><tr><td><span class="property">hibernate.jdbc.batch_versioned_data</span></td><td>Set this property to <code class="literal">true</code> if your JDBC driver returns correct row counts from <code class="literal">executeBatch()</code>. It is usually safe to turn this option on. Hibernate will then use batched DML for automatically versioned data. Defaults to <code class="literal">false</code>. <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.jdbc.factory_class</span></td><td>カスタム <code class="interfacename">org.hibernate.jdbc.Batcher</code> を選びます。ほとんどのアプリケーションに、この設定プロパティは必要ありません。 <p><span class="strong"><strong>例</strong></span><code class="literal">classname.of.BatcherFactory</code> </p></td></tr><tr><td><span class="property">hibernate.jdbc.use_scrollable_resultset</span></td><td>Hibernate による JDBC2 のスクロール可能なリザルトセットの使用を有効にします。このプロパティは、ユーザーによって提供された JDBC コネクションを使用している場合のみ必要で、そうでなければ Hibernate はコネクションメタデータを使用します。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.jdbc.use_streams_for_binary</span></td><td>JDBC へ/から <code class="literal">binary</code> や <code class="literal">serializable</code> の書き込み/読み込みストリームを使います (システムレベルのプロパティ)。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.jdbc.use_get_generated_keys</span></td><td>挿入の後に自動生成された主キーを取得するための JDBC3 <code class="literal">PreparedStatement.getGeneratedKeys()</code> の使用を有効にします。これは JDBC3+ ドライバと JRE1.4+ を必要とし、もし Hibernate の識別子ジェネレータに問題が発生するようなら false に設定してください。デフォルトではコネクションメタデータを使いドライバの能力を決定します。 <p><span class="strong"><strong>例</strong></span><code class="literal">true|false</code> </p></td></tr><tr><td><span class="property">hibernate.connection.provider_class</span></td><td>JDBC コネクションを Hibernate に提供する独自の <code class="literal">ConnectionProvider</code> のクラス名。 <p><span class="strong"><strong>例</strong></span><code class="literal">classname.of.ConnectionProvider</code> </p></td></tr><tr><td><span class="property">hibernate.connection.isolation</span></td><td>JDBC トランザクション分離レベルを設定します。妥当な値を調べるためには <code class="interfacename">java.sql.Connection</code> をチェックしてください。しかし使用するデータベースが、すべての分離レベルをサポートしているとは限りません。 <p><span class="strong"><strong>例</strong></span><code class="literal">1, 2, 4, 8</code> </p></td></tr><tr><td><span class="property">hibernate.connection.autocommit</span></td><td>プールされている JDBC コネクションの自動コミットを有効にする（非推奨）。 <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><span class="property">hibernate.connection.release_mode</span></td><td>Hibernate がいつ JDBC コネクションをリリースするかを指定します。デフォルトではセッションが明示的にクローズまたは切断されてもコネクションは保持します。アプリケーションサーバーの JTA データソースの場合、すべての JDBC コールの後、強制的にコネクションをリリースするために <code class="literal">after_statement</code> を使ってください。非 JTA コネクションの場合、各トランザクションが終了したときに <code class="literal">after_transaction</code> を使い、コネクションをリリースしてください。 <code class="literal">auto</code> にすると、 JTA や CMT トランザクションの場合、 <code class="literal">after_statement</code> でクローズし、 JDBC トランザクションの場合、 <code class="literal">after_transaction</code> でクローズします。 <p><span class="strong"><strong>例</strong></span><code class="literal">auto</code> (デフォルト) | <code class="literal">on_close</code> | <code class="literal">after_transaction</code> | <code class="literal">after_statement</code> </p> <p>This setting only affects <code class="literal">Session</code>s returned from <code class="literal">SessionFactory.openSession</code>. For <code class="literal">Session</code>s obtained through <code class="literal">SessionFactory.getCurrentSession</code>, the <code class="literal">CurrentSessionContext</code> implementation configured for use controls the connection release mode for those <code class="literal">Session</code>s. See <a class="xref" href="architecture.html#architecture-current-session" title="2.3. コンテキスト上のセッション">「コンテキスト上のセッション」</a> </p></td></tr><tr><td><span class="property">hibernate.connection.</span><span class="emphasis"><em>&lt;propertyName&gt;</em></span></td><td>JDBC プロパティ <span class="emphasis"><em>&lt;propertyName&gt;</em></span> を <code class="literal">DriverManager.getConnection()</code> に渡します。</td></tr><tr><td><span class="property">hibernate.jndi.</span><span class="emphasis"><em>&lt;propertyName&gt;</em></span></td><td>プロパティ <span class="emphasis"><em>&lt;propertyName&gt;</em></span> を JNDI <code class="literal">InitialContextFactory</code> に渡します。</td></tr></tbody></table></div></div><br class="table-break"/><div class="table"><a id="configuration-cache-properties"/><p class="title"><b>表3.5 Hibernate キャッシュプロパティ</b></p><div class="table-contents"><table summary="Hibernate キャッシュプロパティ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>プロパティ名</th><th>意味</th></tr></thead><tbody><tr><td><code class="literal">hibernate.cache.provider_class</code></td><td>カスタム <code class="literal">CacheProvider</code> のクラス名です。 <p><span class="strong"><strong>例</strong></span><code class="literal">classname.of.CacheProvider</code> </p></td></tr><tr><td><code class="literal">hibernate.cache.use_minimal_puts</code></td><td>書き込みを最小限にするために、二次キャッシュの操作を最適化します。その代わりに、読み込みがより頻繁に発生するようになります。このセッティングはクラスタキャッシュで役に立ちます。 Hibernate3 ではクラスタキャッシュ実装用にデフォルトでは有効になっています。  <p><span class="strong"><strong>例</strong></span><code class="literal">true|false</code> </p></td></tr><tr><td><code class="literal">hibernate.cache.use_query_cache</code></td><td>特定のクエリがキャッシュ可能な場合に、クエリキャッシュを有効にします。  <p><span class="strong"><strong>例</strong></span><code class="literal">true|false</code> </p></td></tr><tr><td><code class="literal">hibernate.cache.use_second_level_cache</code></td><td>二次キャッシュを完全に無効にする場合に使います。デフォルトでは有効で、クラスの <code class="literal">&lt;cache&gt;</code> マッピングで制御します。 <p><span class="strong"><strong>例</strong></span><code class="literal">true|false</code> </p></td></tr><tr><td><code class="literal">hibernate.cache.query_cache_factory</code></td><td>カスタム <code class="literal">QueryCache</code> インターフェースのクラス名を指定します。デフォルトでは <code class="literal">StandardQueryCache</code> になります。 <p><span class="strong"><strong>e.g.</strong></span> <code class="literal">classname.of.QueryCache</code> </p></td></tr><tr><td><code class="literal">hibernate.cache.region_prefix</code></td><td>二次キャッシュの領域名の接頭辞です。 <p><span class="strong"><strong>例</strong></span><code class="literal">prefix</code> </p></td></tr><tr><td><code class="literal">hibernate.cache.use_structured_entries</code></td><td>二次キャッシュに格納するデータを、人が理解しやすいフォーマットにします。  <p><span class="strong"><strong>例</strong></span><code class="literal">true|false</code> </p></td></tr><tr><td><code class="literal">hibernate.cache.default_cache_concurrency_strategy</code></td><td>Setting used to give the name of the default <code class="classname">org.hibernate.annotations.CacheConcurrencyStrategy</code> to use when either <code class="classname">@Cacheable</code> or <code class="classname">@Cache</code> is used. <code class="code">@Cache(strategy="..")</code> is used to override this default.</td></tr></tbody></table></div></div><br class="table-break"/><div class="table"><a id="configuration-transaction-properties"/><p class="title"><b>表3.6 Hibernate トランザクションプロパティ</b></p><div class="table-contents"><table summary="Hibernate トランザクションプロパティ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>プロパティ名</th><th>意味</th></tr></thead><tbody><tr><td><code class="literal">hibernate.transaction.factory_class</code></td><td>Hibernate <code class="literal">Transaction</code> API と一緒に使われる <code class="literal">TransactionFactory</code> のクラス名です。 （デフォルトでは <code class="literal">JDBCTransactionFactory</code> です）。 <p><span class="strong"><strong>例</strong></span><code class="literal">classname.of.TransactionFactory</code>
&gt; </p></td></tr><tr><td><code class="literal">jta.UserTransaction</code></td><td>アプリケーションサーバーから JTA <code class="literal">UserTransaction</code> を取得するために <code class="literal">JTATransactionFactory</code> に使われる JNDI 名です。 <p><span class="strong"><strong>例</strong></span><code class="literal">jndi/composite/name</code> </p></td></tr><tr><td><code class="literal">hibernate.transaction.manager_lookup_class</code></td><td><code class="literal">TransactionManagerLookup</code> のクラス名です。 JTA 環境において、 JVM レベルのキャッシュを有効にするときか、 hilo ジェネレータが使用されるときに必要です。 <p><span class="strong"><strong>例</strong></span><code class="literal">classname.of.TransactionManagerLookup</code> </p></td></tr><tr><td><code class="literal">hibernate.transaction.flush_before_completion</code></td><td>If enabled, the session will be automatically flushed during the before completion phase of the transaction. Built-in and automatic session context management is preferred, see <a class="xref" href="architecture.html#architecture-current-session" title="2.3. コンテキスト上のセッション">「コンテキスト上のセッション」</a>. <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><code class="literal">hibernate.transaction.auto_close_session</code></td><td>If enabled, the session will be automatically closed during the after completion phase of the transaction. Built-in and automatic session context management is preferred, see <a class="xref" href="architecture.html#architecture-current-session" title="2.3. コンテキスト上のセッション">「コンテキスト上のセッション」</a>. <p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr></tbody></table></div></div><br class="table-break"/><div class="table"><a id="configuration-misc-properties"/><p class="title"><b>表3.7 その他のプロパティ</b></p><div class="table-contents"><table summary="その他のプロパティ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>プロパティ名</th><th>意味</th></tr></thead><tbody><tr><td><code class="literal">hibernate.current_session_context_class</code></td><td>Supply a custom strategy for the scoping of the "current" <code class="literal">Session</code>. See <a class="xref" href="architecture.html#architecture-current-session" title="2.3. コンテキスト上のセッション">「コンテキスト上のセッション」</a> for more information about the built-in strategies. <p><span class="strong"><strong>例</strong></span><code class="literal">jta</code> | <code class="literal">thread</code> | <code class="literal">managed</code> | <code class="literal">custom.Class</code> </p></td></tr><tr><td><code class="literal">hibernate.query.factory_class</code></td><td>HQL パーサーの実装を選択します。 <p><span class="strong"><strong>例</strong></span><code class="literal">org.hibernate.hql.ast.ASTQueryTranslatorFactory</code> or <code class="literal">org.hibernate.hql.classic.ClassicQueryTranslatorFactory</code> </p></td></tr><tr><td><code class="literal">hibernate.query.substitutions</code></td><td>HQL と SQL のトークンをマッピングします。 （例えば、トークンは関数やリテラル名です）。 <p><span class="strong"><strong>例</strong></span><code class="literal">hqlLiteral=SQL_LITERAL, hqlFunction=SQLFUNC</code> </p></td></tr><tr><td><code class="literal">hibernate.hbm2ddl.auto</code></td><td><code class="literal">SessionFactory</code> を生成したときに、自動的にスキーマ DDL を有効にしデータベースに出力します。 <code class="literal">create-drop</code> の場合、 <code class="literal">SessionFactory</code> をクローズしたときに、データベーススキーマをドロップします。 <p><span class="strong"><strong>例</strong></span> <code class="literal">validate</code> | <code class="literal">update</code> | <code class="literal">create</code> | <code class="literal">create-drop</code> </p></td></tr><tr><td><code class="literal">hibernate.hbm2ddl.import_files</code></td><td><p>Comma-separated names of the optional files containing SQL DML statements executed during the <code class="classname">SessionFactory</code> creation. This is useful for testing or demoing: by adding INSERT statements for example you can populate your database with a minimal set of data when it is deployed.</p><p>File order matters, the statements of a give file are executed before the statements of the following files. These statements are only executed if the schema is created ie if <code class="literal">hibernate.hbm2ddl.auto</code> is set to <code class="literal">create</code> or <code class="literal">create-drop</code>.</p><p><span class="strong"><strong>e.g.</strong></span> <code class="literal">/humans.sql,/dogs.sql</code> </p></td></tr><tr><td><code class="literal">hibernate.bytecode.use_reflection_optimizer</code></td><td><p>Enables the use of bytecode manipulation instead of runtime reflection. This is a System-level property and cannot be set in <code class="literal">hibernate.cfg.xml</code>. Reflection can sometimes be useful when troubleshooting. Hibernate always requires either CGLIB or javassist even if you turn off the optimizer.</p><p><span class="strong"><strong>例</strong></span><code class="literal">true</code> | <code class="literal">false</code> </p></td></tr><tr><td><code class="literal">hibernate.bytecode.provider</code></td><td><p>Both javassist or cglib can be used as byte manipulation engines; the default is <code class="literal">javassist</code>.</p><p><span class="strong"><strong>e.g.</strong></span> <code class="literal">javassist</code> | <code class="literal">cglib</code> </p></td></tr></tbody></table></div></div><br class="table-break"/><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-optional-dialects"/>3.4.1. SQL 方言（Dialect）</h3></div></div></div><p><code class="literal">hibernate.dialect</code> プロパティには、使用するデータベースの正しい <code class="literal">org.hibernate.dialect.Dialect</code> のサブクラスを、必ず指定すべきです。しかし方言を指定すれば、 Hibernate は上述したプロパティのいくつかについて、より適切なデフォルト値を使います。そうすれば、それらを手作業で設定する手間が省けます。</p><div class="table"><a id="sql-dialects"/><p class="title"><b>表3.8 Hibernate SQL Dialects (<code class="literal">hibernate.dialect</code>)</b></p><div class="table-contents"><table summary="Hibernate SQL Dialects (hibernate.dialect)" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>RDBMS</th><th>Dialect</th></tr></thead><tbody><tr><td>DB2</td><td><code class="literal">org.hibernate.dialect.DB2Dialect</code></td></tr><tr><td>DB2 AS/400</td><td><code class="literal">org.hibernate.dialect.DB2400Dialect</code></td></tr><tr><td>DB2 OS390</td><td><code class="literal">org.hibernate.dialect.DB2390Dialect</code></td></tr><tr><td>PostgreSQL</td><td><code class="literal">org.hibernate.dialect.PostgreSQLDialect</code></td></tr><tr><td>MySQL5</td><td><code class="literal">org.hibernate.dialect.MySQL5Dialect</code></td></tr><tr><td>MySQL5 with InnoDB</td><td><code class="literal">org.hibernate.dialect.MySQL5InnoDBDialect</code></td></tr><tr><td>MySQL with MyISAM</td><td><code class="literal">org.hibernate.dialect.MySQLMyISAMDialect</code></td></tr><tr><td>Oracle （いずれのバージョンでも）</td><td><code class="literal">org.hibernate.dialect.OracleDialect</code></td></tr><tr><td>Oracle 9i</td><td><code class="literal">org.hibernate.dialect.Oracle9iDialect</code></td></tr><tr><td>Oracle 10g</td><td><code class="literal">org.hibernate.dialect.Oracle10gDialect</code></td></tr><tr><td>Oracle 11g</td><td><code class="literal">org.hibernate.dialect.Oracle10gDialect</code></td></tr><tr><td>Sybase</td><td><code class="literal">org.hibernate.dialect.SybaseASE15Dialect</code></td></tr><tr><td>Sybase Anywhere</td><td><code class="literal">org.hibernate.dialect.SybaseAnywhereDialect</code></td></tr><tr><td>Microsoft SQL Server 2000</td><td><code class="literal">org.hibernate.dialect.SQLServerDialect</code></td></tr><tr><td>Microsoft SQL Server 2005</td><td><code class="literal">org.hibernate.dialect.SQLServer2005Dialect</code></td></tr><tr><td>Microsoft SQL Server 2008</td><td><code class="literal">org.hibernate.dialect.SQLServer2008Dialect</code></td></tr><tr><td>SAP DB</td><td><code class="literal">org.hibernate.dialect.SAPDBDialect</code></td></tr><tr><td>Informix</td><td><code class="literal">org.hibernate.dialect.InformixDialect</code></td></tr><tr><td>HypersonicSQL</td><td><code class="literal">org.hibernate.dialect.HSQLDialect</code></td></tr><tr><td>H2 Database</td><td><code class="literal">org.hibernate.dialect.H2Dialect</code></td></tr><tr><td>Ingres</td><td><code class="literal">org.hibernate.dialect.IngresDialect</code></td></tr><tr><td>Progress</td><td><code class="literal">org.hibernate.dialect.ProgressDialect</code></td></tr><tr><td>Mckoi SQL</td><td><code class="literal">org.hibernate.dialect.MckoiDialect</code></td></tr><tr><td>Interbase</td><td><code class="literal">org.hibernate.dialect.InterbaseDialect</code></td></tr><tr><td>Pointbase</td><td><code class="literal">org.hibernate.dialect.PointbaseDialect</code></td></tr><tr><td>FrontBase</td><td><code class="literal">org.hibernate.dialect.FrontbaseDialect</code></td></tr><tr><td>Firebird</td><td><code class="literal">org.hibernate.dialect.FirebirdDialect</code></td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-optional-outerjoin"/>3.4.2. 外部結合フェッチ</h3></div></div></div><p>もしデータベースが ANSI か、 Oracle か Sybase スタイルの外部結合をサポートしている場合、 <span class="emphasis"><em>outer join fetching</em></span> は、データベースの SQL 発行回数を節約しパフォーマンスを良くします（データベース内でより多くの処理コストが発生します）。外部結合フェッチは、多対一、一対多、多対多、一対一のオブジェクト関連でグループオブジェクトを1つの SQL で <code class="literal">SELECT</code> します。</p><p><code class="literal">hibernate.max_fetch_depth</code> プロパティの値を <code class="literal">0</code> にすると外部結合フェッチを <span class="emphasis"><em>すべて</em></span> 無効にすることになります。 <code class="literal">1</code> やそれ以上の値を設定すると、外部結合フェッチが有効になり、一対一と多対一関連が <code class="literal">fetch="join"</code> としてマッピングされます。</p><p>See <a class="xref" href="performance.html#performance-fetching" title="21.1. フェッチ戦略">「フェッチ戦略」</a> for more information.</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-optional-binarystreams"/>3.4.3. バイナリストリーム</h3></div></div></div><p>Oracle は JDBC ドライバとの間でやりとりされる <code class="literal">byte</code> 配列のサイズを制限します。 <code class="literal">binary</code> や <code class="literal">serializable</code> 型の大きなインスタンスを使いたければ、 <code class="literal">hibernate.jdbc.use_streams_for_binary</code> を有効にしてください。 ただし <span class="emphasis"><em>これはシステムレベルの設定だけです</em></span> 。</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-optional-cacheprovider"/>3.4.4. ニ次キャッシュとクエリキャッシュ</h3></div></div></div><p>The properties prefixed by <code class="literal">hibernate.cache</code> allow you to use a process or cluster scoped second-level cache system with Hibernate. See the <a class="xref" href="performance.html#performance-cache" title="21.2. 第2レベルキャッシュ">「第2レベルキャッシュ」</a> for more information.</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-optional-querysubstitution"/>3.4.5. クエリ言語の置き換え</h3></div></div></div><p><code class="literal">hibernate.query.substitutions</code> を使うことで、新しい Hibernate クエリトークンを定義できます。例：</p><pre class="programlisting">hibernate.query.substitutions true=1, false=0</pre><p>これはトークン <code class="literal">true</code> と <code class="literal">false</code> を、生成される SQL において整数リテラルに翻訳します。</p><pre class="programlisting">hibernate.query.substitutions toLowercase=LOWER</pre><p>これは SQL の <code class="literal">LOWER</code> 関数の名前の付け替えを可能にします。</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-optional-statistics"/>3.4.6. Hibernate 統計</h3></div></div></div><p><code class="literal">hibernate.generate_statistics</code> を有効にした場合、動作しているシステムをチューニングするときに、 <code class="literal">SessionFactory.getStatistics()</code> を経由して、 Hibernate は便利な統計情報を出力します。 JMX を経由して統計情報を出力することも可能です。 Javadoc の <code class="literal">org.hibernate.stats</code> パッケージ内のインターフェースにはより多くの情報があります。</p></div></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-logging"/>3.5. ロギング</h2></div></div></div><p>Hibernate utilizes <a class="ulink" href="http://www.slf4j.org/">Simple Logging Facade for Java</a> (SLF4J) in order to log various system events. SLF4J can direct your logging output to several logging frameworks (NOP, Simple, log4j version 1.2, JDK 1.4 logging, JCL or logback) depending on your chosen binding. In order to setup logging you will need <code class="filename">slf4j-api.jar</code> in your classpath together with the jar file for your preferred binding - <code class="filename">slf4j-log4j12.jar</code> in the case of Log4J. See the SLF4J <a class="ulink" href="http://www.slf4j.org/manual.html">documentation</a> for more detail. To use Log4j you will also need to place a <code class="filename">log4j.properties</code> file in your classpath. An example properties file is distributed with Hibernate in the <code class="literal">src/</code> directory.</p><p>Hibernate のログメッセージに慣れることを強くおすすめします。 Hibernate のログは読みやすく、できる限り詳細になるように努力されています。これは必須のトラブルシューティングデバイスです。以下に重要なログのカテゴリを示します:</p><div class="table"><a id="log-categories"/><p class="title"><b>表3.9 Hibernate ログカテゴリ</b></p><div class="table-contents"><table summary="Hibernate ログカテゴリ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>カテゴリ</th><th>機能</th></tr></thead><tbody><tr><td><code class="literal">org.hibernate.SQL</code></td><td>実行したすべての SQL（DDL）ステートメントをロギングします。</td></tr><tr><td><code class="literal">org.hibernate.type</code></td><td>すべての JDBC パラメータをロギングします。</td></tr><tr><td><code class="literal">org.hibernate.tool.hbm2ddl</code></td><td>実行したすべての SQL（DDL）ステートメントをロギングします。</td></tr><tr><td><code class="literal">org.hibernate.pretty</code></td><td>session に関連するすべてのエンティティ（最大２０）のフラッシュ時間をロギングします。</td></tr><tr><td><code class="literal">org.hibernate.cache</code></td><td>すべてのニ次キャッシュの動作をロギングします。</td></tr><tr><td><code class="literal">org.hibernate.transaction</code></td><td>トランザクションに関連する動作をロギングします。</td></tr><tr><td><code class="literal">org.hibernate.jdbc</code></td><td>JDBC リソース取得をロギングします。</td></tr><tr><td><code class="literal">org.hibernate.hql.ast.AST</code></td><td>HQL と SQL の AST のクエリパースをロギングします。</td></tr><tr><td><code class="literal">org.hibernate.secure</code></td><td>すべての JAAS 分析をロギングします。</td></tr><tr><td><code class="literal">org.hibernate</code></td><td>すべてをロギングします。（情報が大量になりますが、トラブルシューティングには便利です）</td></tr></tbody></table></div></div><br class="table-break"/><p>Hibernate でアプリケーションを作成するときは、 <code class="literal">org.hibernate.SQL</code> カテゴリの <code class="literal">debug</code> を常に有効にしておいたほうが良いでしょう。代替方法として、 <code class="literal">hibernate.show_sql</code> プロパティを有効にする方法があります。</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-namingstrategy"/>3.6. <code class="literal">NamingStrategy</code> を選択</h2></div></div></div><p>インターフェース <code class="literal">net.sf.hibernate.cfg.NamingStrategy</code> を使うとデータベースオブジェクトとスキーマ要素のための「命名標準」を指定できます。</p><p>Java の識別子からデータベースの識別子を自動生成するためのルールや、マッピングファイルで与えた「論理的な」カラムとテーブル名から「物理的な」テーブルとカラム名を生成するためのルールを用意することができます。この機能は繰り返しの雑音（例えば <code class="literal">TBL_</code> プリフィックス）を取り除き、マッピングドキュメントの冗長さを減らすことに役立ちます。 Hibernate が使うデフォルトの戦略はかなり最小限に近いものです。</p><p>マッピングを追加する前に <code class="literal">Configuration.setNamingStrategy()</code> を呼ぶことで以下のように異なる戦略を指定することができます：</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">SessionFactory</span><!-- <br/> --><span class="java_plain">&nbsp;sf&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setNamingStrategy</span><span class="java_separator">(</span><span class="java_type">ImprovedNamingStrategy</span><span class="java_separator">.</span><span class="java_plain">INSTANCE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addFile</span><span class="java_separator">(</span><span class="java_literal">&quot;Item.hbm.xml&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addFile</span><span class="java_separator">(</span><span class="java_literal">&quot;Bid.hbm.xml&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildSessionFactory</span><span class="java_separator">();</span></pre><p><code class="literal">org.hibernate.cfg.ImprovedNamingStrategy</code> は組み込みの戦略です。これはいくつかのアプリケーションにとって有用な開始点となるかもしれません。</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="d0e3252"/>3.7. Implementing a PersisterClassProvider</h2></div></div></div><p>You can configure the persister implementation used to persist your entities and collections:</p><div class="itemizedlist"><ul><li><p>by default, Hibernate uses persisters that make sense in a relational model and follow Java Persistence's specification</p></li><li><p>you can define a <code class="classname">PersisterClassProvider</code> implementation that provides the persister class used of a given entity or collection</p></li><li><p>finally, you can override them on a per entity and collection basis in the mapping using <code class="classname">@Persister</code> or its XML equivalent</p></li></ul></div><p>The latter in the list the higher in priority.</p><p>You can pass the <code class="classname">PersisterClassProvider</code> instance to the <code class="classname">Configuration</code> object.</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">SessionFactory</span><!-- <br/> --><span class="java_plain">&nbsp;sf&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setPersisterClassProvider</span><span class="java_separator">(</span><span class="java_plain">customPersisterClassProvider</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">addAnnotatedClass</span><span class="java_separator">(</span><span class="java_type">Order</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildSessionFactory</span><span class="java_separator">();</span></pre><p>The persister class provider methods, when returning a non null persister class, override the default Hibernate persisters. The entity name or the collection role are passed to the methods. It is a nice way to centralize the overriding logic of the persisters instead of spreading them on each entity or collection mapping.</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-xmlconfig"/>3.8. XML 設定ファイル</h2></div></div></div><p>もう1つの方法は <code class="literal">hibernate.cfg.xml</code> という名前のファイルで十分な設定を指定する方法です。このファイルは <code class="literal">hibernate.properties</code> ファイルの代わりとなります。もし両方のファイルがあれば、プロパティが置き換えられます。</p><p>XML 設定ファイルは初期設定で <code class="literal">CLASSPATH</code> の root に配置してください。これが例です：</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_processing_instruction">&lt;?xml&nbsp;version='1.0'&nbsp;encoding='utf-8'?&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_plain">!</span><span class="xml_attribute_name">DOCTYPE</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">hibernate-configuration</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">PUBLIC</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_value">&quot;-//Hibernate/Hibernate&nbsp;Configuration&nbsp;DTD//EN&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_value">&quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">hibernate-configuration</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;a&nbsp;SessionFactory&nbsp;instance&nbsp;listed&nbsp;as&nbsp;/jndi/name&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">session-factory</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;java:hibernate/SessionFactory&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;properties&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;connection.datasource&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">java:/comp/env/jdbc/MyDB</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;dialect&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.dialect.MySQLDialect</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;show_sql&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">false</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;transaction.factory_class&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.hibernate.transaction.JTATransactionFactory</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;jta.UserTransaction&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">java:comp/UserTransaction</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;mapping&nbsp;files&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">mapping</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">resource</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org/hibernate/auction/Item.hbm.xml&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">mapping</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">resource</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org/hibernate/auction/Bid.hbm.xml&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;cache&nbsp;settings&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">class-cache</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.hibernate.auction.Item&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">usage</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;read-write&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">class-cache</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.hibernate.auction.Bid&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">usage</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;read-only&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">collection-cache</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">collection</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.hibernate.auction.Item.bids&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">usage</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;read-write&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">session-factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">hibernate-configuration</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>見てのとおり、この方法の優位性は設定のためのマッピングファイル名を外出しにできることです。 Hibernate キャッシュをチューニングしなければならないのであれば、 <code class="literal">hibernate.cfg.xml</code> はより便利です。 <code class="literal">hibernate.properties</code> と <code class="literal">hibernate.cfg.xml</code> の どちらかを使えることを覚えておいてください。2つは同じもので、違うところといえば XML 構文を使うことの利点だけです。</p><p>XML 設定を使うことで、 Hibernate は以下のようにシンプルになります。</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">SessionFactory</span><!-- <br/> --><span class="java_plain">&nbsp;sf&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">configure</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">buildSessionFactory</span><!-- <br/> --><span class="java_separator">();</span></pre><p>違う XML 設定ファイルを使うこともできます。</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">SessionFactory</span><!-- <br/> --><span class="java_plain">&nbsp;sf&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">(</span><span class="java_literal">&quot;catdb.cfg.xml&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildSessionFactory</span><span class="java_separator">();</span></pre></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-j2ee"/>3.9. Java EE Application Server integration</h2></div></div></div><p>Hibernate は J2EE 構造と統合するポイントをサポートしています:</p><div class="itemizedlist"><ul><li><p><span class="emphasis"><em>コンテナ管理データソース</em></span>： Hibernate は JNDI が提供し、コンテナが管理する JDBC コネクションを使用できます。通常、 JTA 準拠の <code class="literal">TransactionManager</code> と <code class="literal">ResourceManager</code> がトランザクション管理 (CMT)、特に様々なデータソースにまたがる分散トランザクションを扱います。当然プログラムでトランザクション境界を指定できます (BMT)。あるいは、記述したコードのポータビリティを保つために、オプションの Hibernate の <code class="literal">Transaction</code> API を使いたくなるかもしれません。</p></li></ul></div><div class="itemizedlist"><ul><li><p><span class="emphasis"><em>自動 JNDI バインディング</em></span>： Hibernate は JNDI が立ち上がった後に <code class="literal">SessionFactory</code> を生成します。</p></li></ul></div><div class="itemizedlist"><ul><li><p><span class="emphasis"><em> JTA セッションバインディング</em></span>： Hibernate <code class="literal">Session</code> は自動的に JTA トランザクションのスコープにバインドされます。単純に <code class="literal">SessionFactory</code> を JNDI から lookup して、現在の <code class="literal">Session</code> を取得します。 JTA トランザクションが完了したときに、 Hibernateが <code class="literal">Session</code> をフラッシュし、クローズします。トランザクション境界は、宣言 (CMT) することも、プログラム (BMT/UserTransaction) することも可能です。</p></li></ul></div><div class="itemizedlist"><ul><li><p><span class="emphasis"><em> JMX デプロイメント:</em></span> もし JMX が使用可能なアプリケーションサーバー（例えば JBoss AS） がある場合、 Hibernate を MBean としてデプロイすることを選べます。これは <code class="literal">Configuration</code> から <code class="literal">SessionFactory</code> を生成するコードを無くすことができます。コンテナは <code class="literal">HibernateService</code> を起動し、サービスの依存を理想的に管理します（データソースは Hibernate やその他が起動する前に使用できるようにしなければなりません）。</p></li></ul></div><p>環境に依存しますが、もしアプリケーションサーバーが "connection containment" の例外を出す場合、設定のオプション <code class="literal">hibernate.connection.aggressive_release</code> を true にしてください。</p><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-optional-transactionstrategy"/>3.9.1. トランザクション戦略設定</h3></div></div></div><p>Hibernate <code class="literal">Session</code> API は、アーキテクチャ内のシステムの管轄であるあらゆるトランザクションに依存しません。もしコネクションプールの JDBC を直接使いたい場合、 JDBC API から トランザクションを呼ぶことができます。もし、 J2EE アプリケーションサーバーで動作させるなら、 Bean 管理トランザクションを使い、必要に応じて <code class="literal">UserTransaction</code> を JTA API から呼ぶことになるでしょう。</p><p>2つ（それ以上）の環境で互換性のあるコードを維持するために、オプションとして根本的なシステムをラッピングする Hibernate <code class="literal">Transaction</code> API を推奨します。 Hibernate 設定プロパティの <code class="literal">hibernate.transaction.factory_class</code> を設定することで、ある特定の <code class="literal">Transaction</code> クラスのインスタンスを持つことができます。</p><p>3つの基本的な（既にある）選択を挙げます：</p><div class="variablelist"><dl><dt><span class="term"><code class="literal">org.hibernate.transaction.JDBCTransactionFactory</code></span></dt><dd><p>データベース (JDBC) トランザクションに委譲します（デフォルト）</p></dd><dt><span class="term"><code class="literal">org.hibernate.transaction.JTATransactionFactory</code></span></dt><dd><p>もし、このコンテキスト（例えば、 EJB セッション Bean メソッド）で進行中のトランザクションが存在する場合、コンテナ管理トランザクションに委譲します。そうでない場合は、新しいトランザクションが開始されており、 Bean 管理トランザクションが使われます。</p></dd><dt><span class="term"><code class="literal">org.hibernate.transaction.CMTTransactionFactory</code></span></dt><dd><p>コンテナ管理 JTA トランザクションに委譲します</p></dd></dl></div><p>自分自身のトランザクション戦略（例えば、 CORBA トランザクションサービス）を定義することもできます。</p><p>Hibernate のいくつかの機能（例えば、二次キャッシュ、 JTA によるコンテキストセッション等）は管理された環境の中の JTA <code class="literal">TransactionManager</code> へのアクセスを要求します。 J2EE がひとつのメカニズムに規格化されていないので、アプリケーションサーバーにおいて、 Hibernateが <code class="literal">TransactionManager</code> のリファレンスを取得する方法を明確にする必要があります。</p><div class="table"><a id="jtamanagerlookup"/><p class="title"><b>表3.10 JTA トランザクションマネージャ</b></p><div class="table-contents"><table summary="JTA トランザクションマネージャ" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>Transaction Factory</th><th align="center">Application Server</th></tr></thead><tbody><tr><td><code class="literal">org.hibernate.transaction.JBossTransactionManagerLookup</code></td><td align="center">JBoss AS</td></tr><tr><td><code class="literal">org.hibernate.transaction.WeblogicTransactionManagerLookup</code></td><td align="center">Weblogic</td></tr><tr><td><code class="literal">org.hibernate.transaction.WebSphereTransactionManagerLookup</code></td><td align="center">WebSphere</td></tr><tr><td><code class="literal">org.hibernate.transaction.WebSphereExtendedJTATransactionLookup</code></td><td align="center">WebSphere 6</td></tr><tr><td><code class="literal">org.hibernate.transaction.OrionTransactionManagerLookup</code></td><td align="center">Orion</td></tr><tr><td><code class="literal">org.hibernate.transaction.ResinTransactionManagerLookup</code></td><td align="center">Resin</td></tr><tr><td><code class="literal">org.hibernate.transaction.JOTMTransactionManagerLookup</code></td><td align="center">JOTM</td></tr><tr><td><code class="literal">org.hibernate.transaction.JOnASTransactionManagerLookup</code></td><td align="center">JOnAS</td></tr><tr><td><code class="literal">org.hibernate.transaction.JRun4TransactionManagerLookup</code></td><td align="center">JRun4</td></tr><tr><td><code class="literal">org.hibernate.transaction.BESTransactionManagerLookup</code></td><td align="center">Borland ES</td></tr><tr><td><code class="literal">org.hibernate.transaction.JBossTSStandaloneTransactionManagerLookup</code></td><td align="center">JBoss TS used standalone (ie. outside JBoss AS and a JNDI environment generally). Known to work for <code class="literal">org.jboss.jbossts:jbossjta:4.11.0.Final</code></td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-optional-jndi"/>3.9.2. <code class="literal">SessionFactory</code> の JNDI への登録</h3></div></div></div><p>JNDI に登録した Hibernate <code class="literal">SessionFactory</code> はファクトリのルックアップと新しい <code class="literal">Session</code> の作成を簡易化します。これは JNDI に登録された <code class="literal">Datasource</code> には関連せず、両方とも単に同じ登録を使うことに注意してください。</p><p>もし <code class="literal">SessionFactory</code> を JNDI ネームスペースに登録したい場合、特別な名前（例えば、 <code class="literal">java:hibernate/SessionFactory</code> ）を <code class="literal">hibernate.session_factory_name</code> プロパティに使ってください。もしこのプロパティを省略した場合、 <code class="literal">SessionFactory</code> は JNDI に登録されません。（これは Tomcat のようなデフォルト実装で JNDI が読み取り専用の環境の場合は特に便利です。）</p><p><code class="literal">SessionFactory</code> を JNDI に登録するとき、 Hibernate は <code class="literal">hibernate.jndi.url</code> の値を使用し、<code class="literal">hibernate.jndi.class</code> をイニシャルコンテキストとして具体化します。もし何も設定しない場合は、デフォルトの <code class="literal">InitialContext</code> を使用します。</p><p><code class="literal">cfg.buildSessionFactory()</code> をコール後 Hibernate は自動的に <code class="literal">SessionFactory</code> を JNDI に配置します。 <code class="literal">HibernateService</code> と一緒に JMX デプロイメントを使わない限り、これはこの呼び出しをアプリケーション内の何らかのスタートアップコード（もしくはユーティリティクラス） に配置しなければならないことを意味します（後で議論します）。</p><p>もし JNDI <code class="literal">SessionFactory</code> を使う場合、 EJB や他のクラスは JNDI ルックアップを使って <code class="literal">SessionFactory</code> を取得します。</p><p>It is recommended that you bind the <code class="literal">SessionFactory</code> to JNDI in a managed environment and use a <code class="literal">static</code> singleton otherwise. To shield your application code from these details, we also recommend to hide the actual lookup code for a <code class="literal">SessionFactory</code> in a helper class, such as <code class="literal">HibernateUtil.getSessionFactory()</code>. Note that such a class is also a convenient way to startup Hibernate—see chapter 1.</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-j2ee-currentsession"/>3.9.3. JTA による現在のセッションコンテキストマネージメント</h3></div></div></div><p>The easiest way to handle <code class="literal">Sessions</code> and transactions is Hibernate's automatic "current" <code class="literal">Session</code> management. For a discussion of contextual sessions see <a class="xref" href="architecture.html#architecture-current-session" title="2.3. コンテキスト上のセッション">「コンテキスト上のセッション」</a>. Using the <code class="literal">"jta"</code> session context, if there is no Hibernate <code class="literal">Session</code> associated with the current JTA transaction, one will be started and associated with that JTA transaction the first time you call <code class="literal">sessionFactory.getCurrentSession()</code>. The <code class="literal">Session</code>s retrieved via <code class="literal">getCurrentSession()</code> in the <code class="literal">"jta"</code> context are set to automatically flush before the transaction completes, close after the transaction completes, and aggressively release JDBC connections after each statement. This allows the <code class="literal">Session</code>s to be managed by the life cycle of the JTA transaction to which it is associated, keeping user code clean of such management concerns. Your code can either use JTA programmatically through <code class="literal">UserTransaction</code>, or (recommended for portable code) use the Hibernate <code class="literal">Transaction</code> API to set transaction boundaries. If you run in an EJB container, declarative transaction demarcation with CMT is preferred.</p></div><div class="section" lang="ja-JP"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-j2ee-jmx"/>3.9.4. JMX デプロイメント</h3></div></div></div><p><code class="literal">SessionFactory</code> を JNDI から取得するためには <code class="literal">cfg.buildSessionFactory()</code> 行をどこかで実行していなければなりません。あなたはこれを、 <code class="literal">static</code> 初期化ブロック内（ <code class="literal">HibernateUtil</code> のような）か <span class="emphasis"><em>managed service</em></span> として Hibernate をデプロイするか、どちらかで実行できます。</p><p>JBoss AS のような JMX の機能でアプリケーションサーバーにデプロイするために <code class="literal">org.hibernate.jmx.HibernateService</code> を使って、配置します。実際のデプロイメントと設定はベンダー特有です。ここで例として JBoss 4.0.x 用の <code class="literal">jboss-service.xml</code> を示します。</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_processing_instruction">&lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">server</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">mbean</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">code</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.hibernate.jmx.HibernateService&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;jboss.jca:service=HibernateFactory,name=HibernateFactory&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Required&nbsp;services&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">depends</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">jboss.jca:service=RARDeployer</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">depends</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">depends</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">jboss.jca:service=LocalTxCM,name=HsqlDS</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">depends</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Bind&nbsp;the&nbsp;Hibernate&nbsp;service&nbsp;to&nbsp;JNDI&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;JndiName&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">java:/hibernate/SessionFactory</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Datasource&nbsp;settings&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Datasource&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">java:HsqlDS</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Dialect&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.dialect.HSQLDialect</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Transaction&nbsp;integration&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;TransactionStrategy&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.hibernate.transaction.JTATransactionFactory</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;TransactionManagerLookupStrategy&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.hibernate.transaction.JBossTransactionManagerLookup</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;FlushBeforeCompletionEnabled&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">true</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;AutoCloseSessionEnabled&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">true</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Fetching&nbsp;options&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;MaximumFetchDepth&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">5</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Second-level&nbsp;caching&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;SecondLevelCacheEnabled&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">true</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;CacheProviderClass&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.cache.EhCacheProvider</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;QueryCacheEnabled&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">true</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Logging&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;ShowSqlEnabled&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">true</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_comment">&lt;!--&nbsp;Mapping&nbsp;files&nbsp;--&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">attribute</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;MapResources&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">auction/Item.hbm.xml,auction/Category.hbm.xml</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">attribute</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">mbean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">server</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre><p>このファイルは <code class="literal">META-INF</code> ディレクトリに配置され、 JAR ファイルを拡張した <code class="literal">.sar</code> (service archive) でパッケージ化されます。同様に Hibernate パッケージも必要です。また、 Hibernate はサードパーティのライブラリも要求します。コンパイルした永続化クラスとそのマッピングファイルも同様にアーカイブ（.sarファイル）に入れます。エンタープライズ Bean （通常はセッション Bean ）は自身の JAR ファイルを保持しますが、1回で（ホット）デプロイ可能なユニットのためにメインサービスアーカイブとしてこの EJB JAR ファイルを含めることができます。 JBoss AS のドキュメントに JXM サービスと EJB デプロイメントのより多くの情報があります。</p></div></div></div><HR xmlns=""/><a xmlns="" href="legalnotice.html"><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">製作著作 © 2004 Red Hat, Inc.</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="architecture.html"><strong>前のページ</strong>第2章 アーキテクチャ</a></li><li class="up"><a accesskey="u" href="#"><strong>上に戻る</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>ホーム</strong></a></li><li class="next"><a accesskey="n" href="persistent-classes.html"><strong>次のページ</strong>第4章 永続クラス</a></li></ul></body></html>