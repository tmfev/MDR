<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 4. Tutorial Using the Java Persistence API (JPA)</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="Hibernate Getting Started Guide"/><link rel="up" href="index.html" title="Hibernate Getting Started Guide"/><link rel="prev" href="hibernate-gsg-tutorial-annotations.html" title="Chapter 3. Tutorial Using Native Hibernate APIs and Annotation Mappings"/><link rel="next" href="hibernate-gsg-tutorial-envers.html" title="Chapter 5. Tutorial Using Envers"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="hibernate-gsg-tutorial-annotations.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="hibernate-gsg-tutorial-envers.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="hibernate-gsg-tutorial-jpa"/>Chapter 4. Tutorial Using the <em class="firstterm"><span>Java Persistence API (JPA)</span></em></h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="hibernate-gsg-tutorial-jpa.html#hibernate-gsg-tutorial-jpa-config">4.1. persistence.xml</a></span></dt><dt><span class="section"><a href="hibernate-gsg-tutorial-jpa.html#hibernate-gsg-tutorial-jpa-entity">4.2. The annotated entity Java class</a></span></dt><dt><span class="section"><a href="hibernate-gsg-tutorial-jpa.html#hibernate-gsg-tutorial-jpa-test">4.3. Example code</a></span></dt></dl></div><p>
        This tutorial is located within the download bundle under <code class="filename">entitymanager</code> and illustrates
        </p><div class="itemizedlist"><ul><li><p>
                    using annotations to provide mapping information
                </p></li><li><p>
                    using <span>JPA</span>
                </p></li></ul></div><p>
    </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="hibernate-gsg-tutorial-jpa-config"/>4.1. <code class="filename">persistence.xml</code></h2></div></div></div><p>
            The previous tutorials used the Hibernate-specific
            <code class="filename"><em class="replaceable"><code>hibernate.cfg.xml</code></em></code> configuration file.  <span>JPA</span>,
            however, defines a different <span>bootstrap</span> process that uses its own configuration file
            named <code class="filename">persistence.xml</code>.  How this <span>bootstrapping</span> works is defined
            by the <span>JPA</span> specification.  In <span class="trademark">Java</span>™ SE environments the
            persistence provider (Hibernate in this case) is required to locate all <span>JPA</span>
            configuration files by classpath lookup of the <code class="filename">META-INF/persistence.xml</code> resource
            name.
        </p><div class="example"><a id="hibernate-gsg-tutorial-jpa-config-pu"/><p class="title"><b>Example 4.1. <code class="filename">persistence.xml</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">persistence</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://java.sun.com/xml/ns/persistence&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns:xsi</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xsi:schemaLocation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://java.sun.com/xml/ns/persistence&nbsp;http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">version</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;2.0&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">persistence-unit</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.hibernate.tutorial.jpa&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">persistence-unit</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">persistence</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><p>
            <code class="filename">persistence.xml</code> files should provide a unique name for each
            <span>persistence unit</span>.  This name is how applications reference the configuration
            while obtaining an <code class="interfacename">javax.persistence.EntityManagerFactory</code> reference.
        </p><p>
            The settings defined in the <code class="literal">properties</code> element were already discussed in
            <a class="xref" href="hibernate-gsg-tutorial-basic.html#hibernate-gsg-tutorial-basic-config" title="2.1. The Hibernate configuration file">Section 2.1, “The Hibernate configuration file”</a>.  Here the <code class="literal">javax.persistence</code>-prefixed
            varieties are used when possible.  For the remaining Hibernate-specific configuration setting names notice
            that they are now prefixed with <code class="literal">hibernate.</code>.
        </p><p>
            Additionally, the <code class="literal">class</code> element functions the same as discussed in
            <a class="xref" href="hibernate-gsg-tutorial-annotations.html#hibernate-gsg-tutorial-annotations-config" title="3.1. The Hibernate configuration file">Section 3.1, “The Hibernate configuration file”</a>.
        </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="hibernate-gsg-tutorial-jpa-entity"/>4.2. The annotated entity Java class</h2></div></div></div><p>
            The entity is exactly the same as that from the annotations tutorial.  See
            <a class="xref" href="hibernate-gsg-tutorial-annotations.html#hibernate-gsg-tutorial-annotations-entity" title="3.2. The annotated entity Java class">Section 3.2, “The annotated entity Java class”</a>
        </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="hibernate-gsg-tutorial-jpa-test"/>4.3. Example code</h2></div></div></div><p>
            The previous tutorials used the Hibernate APIs.  This tutorial uses the <span>JPA</span> APIs.
        </p><div class="example"><a id="hibernate-gsg-tutorial-jpa-test-setUp"/><p class="title"><b>Example 4.2. Obtaining the <code class="interfacename">javax.persistence.EntityManagerFactory</code></b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">protected</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">void</span><!-- <br/> --><span class="java_plain">&nbsp;setUp</span><!-- <br/> --><span class="java_separator">()</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">throws</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Exception</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;entityManagerFactory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Persistence</span><span class="java_separator">.</span><span class="java_plain">createEntityManagerFactory</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;org.hibernate.tutorial.jpa&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>
            Notice again the use of <code class="literal">org.hibernate.tutorial.jpa</code> as the
            <span>persistence unit</span> name, which matches from <a class="xref" href="hibernate-gsg-tutorial-jpa.html#hibernate-gsg-tutorial-jpa-config-pu" title="Example 4.1. persistence.xml">Example 4.1, “persistence.xml”</a>
        </p><div class="example"><a id="hibernate-gsg-tutorial-jpa-test-saving"/><p class="title"><b>Example 4.3. Saving (persisting) entities</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">EntityManager</span><!-- <br/> --><span class="java_plain">&nbsp;entityManager&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;entityManagerFactory</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createEntityManager</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">entityManager</span><span class="java_separator">.</span><span class="java_plain">getTransaction</span><span class="java_separator">().</span><span class="java_plain">begin</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">entityManager</span><span class="java_separator">.</span><span class="java_plain">persist</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Event</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Our&nbsp;very&nbsp;first&nbsp;event!&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">entityManager</span><span class="java_separator">.</span><span class="java_plain">persist</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Event</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;A&nbsp;follow&nbsp;up&nbsp;event&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Date</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">entityManager</span><span class="java_separator">.</span><span class="java_plain">getTransaction</span><span class="java_separator">().</span><span class="java_plain">commit</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">entityManager</span><span class="java_separator">.</span><span class="java_plain">close</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>
            The code is pretty similar to <a class="xref" href="hibernate-gsg-tutorial-basic.html#hibernate-gsg-tutorial-basic-test-saving" title="Example 2.5. Saving entities">Example 2.5, “Saving entities”</a>.  Here
            we use an <code class="interfacename">javax.persistence.EntityManager</code> as opposed to a
            <code class="interfacename">org.hibernate.Session</code>.  <span>JPA</span> calls this operation
            <code class="literal">persist</code> instead of <code class="literal">save</code>.
        </p><div class="example"><a id="hibernate-gsg-tutorial-jpa-test-list"/><p class="title"><b>Example 4.4. Obtaining a list of entities</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">entityManager&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;entityManagerFactory</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createEntityManager</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">entityManager</span><span class="java_separator">.</span><span class="java_plain">getTransaction</span><span class="java_separator">().</span><span class="java_plain">begin</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Event</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;result&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;entityManager</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;from&nbsp;Event&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Event</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">getResultList</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_keyword">for</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Event</span><span class="java_plain">&nbsp;event&nbsp;</span><span class="java_operator">:</span><span class="java_plain">&nbsp;result&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">System</span><span class="java_separator">.</span><span class="java_plain">out</span><span class="java_separator">.</span><span class="java_plain">println</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Event&nbsp;(&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span><span class="java_plain">&nbsp;event</span><span class="java_separator">.</span><span class="java_plain">getDate</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;)&nbsp;:&nbsp;&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span><span class="java_plain">&nbsp;event</span><span class="java_separator">.</span><span class="java_plain">getTitle</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">entityManager</span><span class="java_separator">.</span><span class="java_plain">getTransaction</span><span class="java_separator">().</span><span class="java_plain">commit</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">entityManager</span><span class="java_separator">.</span><span class="java_plain">close</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>
            Again, the code is pretty similar to <a class="xref" href="hibernate-gsg-tutorial-basic.html#hibernate-gsg-tutorial-basic-test-list" title="Example 2.6. Obtaining a list of entities">Example 2.6, “Obtaining a list of entities”</a>.
        </p></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2004 Red Hat, Inc.</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="hibernate-gsg-tutorial-annotations.html"><strong>Prev</strong>Chapter 3. Tutorial Using Native Hibernate APIs a...</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="hibernate-gsg-tutorial-envers.html"><strong>Next</strong>Chapter 5. Tutorial Using Envers</a></li></ul></body></html>