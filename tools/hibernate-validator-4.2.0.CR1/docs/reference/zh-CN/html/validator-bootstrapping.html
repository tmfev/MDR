<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">第 5 章 Bootstrapping</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="Hibernate Validator"/><link rel="up" href="index.html" title="Hibernate Validator"/><link rel="prev" href="validator-xmlconfiguration.html" title="第 4 章 XML configuration"/><link rel="next" href="validator-metadata-api.html" title="第 6 章 Metadata API"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="validator-xmlconfiguration.html"><strong>上一页</strong></a></li><li class="next"><a accesskey="n" href="validator-metadata-api.html"><strong>下一页</strong></a></li></ul><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-bootstrapping"/>第 5 章 Bootstrapping</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="validator-bootstrapping.html#section-validator-instance">5.1. Configuration 和 ValidatorFactory</a></span></dt><dt><span class="section"><a href="validator-bootstrapping.html#section-validation-provider-resolver">5.2. ValidationProviderResolver</a></span></dt><dt><span class="section"><a href="validator-bootstrapping.html#section-message-interpolator">5.3. MessageInterpolator</a></span></dt><dd><dl><dt><span class="section"><a href="validator-bootstrapping.html#section-resource-bundle-locator">5.3.1. ResourceBundleLocator</a></span></dt></dl></dd><dt><span class="section"><a href="validator-bootstrapping.html#d0e2416">5.4. TraversableResolver</a></span></dt><dt><span class="section"><a href="validator-bootstrapping.html#d0e2462">5.5. ConstraintValidatorFactory</a></span></dt></dl></div><p>在<a class="xref" href="validator-bootstrapping.html#section-validator-instance" title="5.1. Configuration 和 ValidatorFactory">第 5.1 节 “Configuration 和 ValidatorFactory”</a>中我们说道过, 最简单的创建一个<code class="classname">Validator</code>实例的方法是通过<code class="methodname">Validation.buildDefaultValidatorFactory</code>. 在本章中我们会继续介绍<code class="classname">javax.validation.Validation</code>中的其他方法, 以及如何通过这些方法在Bean Validation初始化的时候对其进行配置的.</p><p>The different bootstrapping options allow, amongst other things, to bootstrap any Bean Validation implementation on the classpath. 通常, 一个服务的提供者是能够被<a class="ulink" href="http://java.sun.com/j2se/1.3/docs/guide/jar/jar.html#Service%20Provider">Java Service Provider</a>发现的. 对于Bean Validation的实现(服务提供者)来说, 他们的<code class="filename">META-INF/services</code>目录下需要包含一个名为<code class="filename">javax.validation.spi.ValidationProvider</code>的文件. 此文件中包含了一个<code class="classname">ValidationProvider</code>接口的实现类的全路径名称, 具体到Hibernate Validator来说, 就是<code class="classname">org.hibernate.validator.HibernateValidator</code>.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>如果当前类路径下存在多个Bean Validation的实现, 那么<code class="methodname">Validation.buildDefaultValidatorFactory()</code>并不能保证具体那个实现会被使用. 如果想指定某一个的话, 请使用<code class="methodname">Validation.byProvider()</code>.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-validator-instance"/>5.1. <code class="classname">Configuration</code> 和 <code class="classname">ValidatorFactory</code></h2></div></div></div><p>Validation类提供了三种方法来创建一个Validator的实例, <a class="xref" href="validator-bootstrapping.html#example-build-default-validator-factory" title="例 5.1. Validation.buildDefaultValidatorFactory()">例 5.1 “Validation.buildDefaultValidatorFactory()”</a>中显示的是最简单的方法.</p><div class="example"><a id="example-build-default-validator-factory"/><p class="title"><b>例 5.1. Validation.buildDefaultValidatorFactory()</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;factory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p>你也可以通过<code class="methodname">Validation.byDefaultProvider()</code>现获取一个Configuration对象, 这样可以对要创建的Validator进行配置.</p><div class="example"><a id="d0e2260"/><p class="title"><b>例 5.2. Validation.byDefaultProvider()</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_operator">&lt;?&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;config&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">configure</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">config</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyMessageInterpolator</span><span class="java_separator">())</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">traversableResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_separator">())</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraintValidatorFactory</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyConstraintValidatorFactory</span><span class="java_separator">());</span>
</span>
<!--  --><br/><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;factory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;config</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
</pre></div></div><br class="example-break"/><p><code class="classname">MessageInterpolator</code>, <code class="classname">TraversableResolver</code> 和 <code class="classname">ConstraintValidatorFactory</code>会在后面详细介绍.</p><p>最后, 你可以指定使用哪个Bean Validation的实现. 如果类路径下存在多个Bean Validation的实现的话,这样就很有必要了. 例如, 如果你想使用Hibernate Validator来作为内部实现来创建<code class="classname">Validator</code>的话:</p><div class="example"><a id="d0e2280"/><p class="title"><b>例 5.3. Validation.byProvider( HibernateValidator.class )</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">HibernateValidatorConfiguration</span><!-- <br/> --><span class="java_plain">&nbsp;config&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">).</span><!-- <br/> --><span class="java_plain">configure</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">config</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyMessageInterpolator</span><span class="java_separator">())</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">traversableResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_separator">())</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraintValidatorFactory</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyConstraintValidatorFactory</span><span class="java_separator">());</span>
</span>
<!--  --><br/><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;factory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;config</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>创建出来的<code class="classname">Validator</code>实例是线程安全的, 所以你可以把它缓存起来.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-validation-provider-resolver"/>5.2. <code class="classname">ValidationProviderResolver</code></h2></div></div></div><p>如果 Java Service Provider机制在你的环境中不能够正常工作, 或者你有特别的classloader设置的话, 你也可以提供一个自定义的<code class="classname">ValidationProviderResolver</code>.<a class="xref" href="validator-bootstrapping.html#example-provider-resolver" title="例 5.4. 使用自定义的ValidationProviderResolver">例 5.4 “使用自定义的ValidationProviderResolver”</a>显示了如何在OSGi环境中插入自定义的provider resolver.</p><div class="example"><a id="example-provider-resolver"/><p class="title"><b>例 5.4. 使用自定义的ValidationProviderResolver</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_operator">&lt;?&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;config&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">providerResolver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">OSGiServiceDiscoverer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">configure</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;factory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;config</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
</pre></div></div><br class="example-break"/><p>在这种情况下, 你的<code class="classname">OSGiServiceDiscoverer</code>类需要实现<code class="classname">ValidationProviderResolver</code>接口:</p><div class="example"><a id="d0e2316"/><p class="title"><b>例 5.5. ValidationProviderResolver接口</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">interface</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">ValidationProviderResolver</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_javadoc_comment">/**</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Returns&nbsp;a&nbsp;list&nbsp;of&nbsp;ValidationProviders&nbsp;available&nbsp;in&nbsp;the&nbsp;runtime&nbsp;environment.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@return</span><span class="java_javadoc_comment">&nbsp;list&nbsp;of&nbsp;validation&nbsp;providers.&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">ValidationProvider</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">&nbsp;getValidationProviders</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_separator">}</span>
</pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="section-message-interpolator"/>5.3. <code class="classname">MessageInterpolator</code></h2></div></div></div><p><a class="xref" href="validator-usingvalidator.html#section-message-interpolation" title="2.2.4. 验证失败提示信息解析">第 2.2.4 节 “验证失败提示信息解析”</a> already discussed the default message interpolation algorithm. If you have special requirements for your message interpolation you can provide a custom interpolator using <code class="methodname">Configuration.messageInterpolator()</code>. This message interpolator will be shared by all validators generated by the <code class="classname">ValidatorFactory</code> created from this <code class="classname">Configuration</code>. <a class="xref" href="validator-bootstrapping.html#example-message-interpolator" title="例 5.6. 自定义的MessageInterpolator">例 5.6 “自定义的MessageInterpolator”</a> shows an interpolator (available in Hibernate Validator) which can interpolate the value being validated in the constraint message. To refer to this value in the constraint message you can use: </p><div class="itemizedlist"><ul><li><p>${validatedValue}: this will call <code class="methodname">String.valueOf </code>on the validated value.</p></li><li><p>${validatedValue:&lt;format&gt;}: provide your own format string which will be passed to <code class="code">String.format</code> together with the validated value. Refer to the javadoc of <code class="code">String.format</code> for more information about the format options.</p></li></ul></div><div class="example"><a id="example-message-interpolator"/><p class="title"><b>例 5.6. 自定义的MessageInterpolator</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_operator">&lt;?&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;configuration&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">configure</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;factory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;configuration</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ValueFormatterMessageInterpolator</span><span class="java_separator">(</span><span class="java_plain">configuration</span><span class="java_separator">.</span><span class="java_plain">getDefaultMessageInterpolator</span><span class="java_separator">()))</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
</pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>It is recommended that <code class="classname">MessageInterpolator</code> implementations delegate final interpolation to the Bean Validation default <code class="classname">MessageInterpolator</code> to ensure standard Bean Validation interpolation rules are followed. The default implementation is accessible through <code class="methodname">Configuration.getDefaultMessageInterpolator()</code>.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-resource-bundle-locator"/>5.3.1. ResourceBundleLocator</h3></div></div></div><p>一个普遍的需求是你可能需要为错误消息解析指定你自己的resource bundles. <code class="classname">ResourceBundleMessageInterpolator</code>是Hibernate Validator中默认的<code class="classname">MessageInterpolator</code>的实现, 它默认情况下是通过<code class="methodname">ResourceBundle.getBundle</code>来获取resource bundle的. 不过, <code class="classname">ResourceBundleMessageInterpolator</code>也支持你指定一个自定义的<code class="classname">ResourceBundleLocator</code>实现来提供你自己的resource bundle. <a class="xref" href="validator-bootstrapping.html#example-resource-bundle-locator" title="例 5.7. 自定义的ResourceBundleLocator">例 5.7 “自定义的ResourceBundleLocator”</a>提供了一个示例. 在这个例子中, 先通过<code class="methodname"> HibernateValidatorConfiguration.getDefaultResourceBundleLocator</code>获取默认的<code class="classname">ResourceBundleLocator</code>实现, 然后再用你自定义的实现把默认的包装起来, 代理模式.</p><div class="example"><a id="example-resource-bundle-locator"/><p class="title"><b>例 5.7. 自定义的ResourceBundleLocator</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">HibernateValidatorConfiguration</span><!-- <br/> --><span class="java_plain">&nbsp;configure&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">HibernateValidator</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">).</span><!-- <br/> --><span class="java_plain">configure</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">ResourceBundleLocator</span><span class="java_plain">&nbsp;defaultResourceBundleLocator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;configure</span><span class="java_separator">.</span><span class="java_plain">getDefaultResourceBundleLocator</span><span class="java_separator">();</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_type">ResourceBundleLocator</span><span class="java_plain">&nbsp;myResourceBundleLocator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyCustomResourceBundleLocator</span><span class="java_separator">(</span><span class="java_plain">defaultResourceBundleLocator</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">configure</span><span class="java_separator">.</span><span class="java_plain">messageInterpolator</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ResourceBundleMessageInterpolator</span><span class="java_separator">(</span><span class="java_plain">myResourceBundleLocator</span><span class="java_separator">));</span>
</pre></div></div><br class="example-break"/><p>Hibernate Validator提供了两个<code class="classname">ResourceBundleLocator</code>的实现 - <code class="classname">PlatformResourceBundleLocator</code> (默认) 和 <code class="classname">AggregateResourceBundleLocator</code>. 后者可以定义一系列的resource bundle, 然后它会读取这些文件, 并且把它们组合成一个. 更多信息请参考此类的javadoc 文档.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e2416"/>5.4. <code class="classname">TraversableResolver</code></h2></div></div></div><p>到目前位置我们还没有讨论过<code class="classname">TraversableResolver</code>接口, 它的设计目的是在某些情况下, 我们可能不应该去获取一个属性的状态. 最典型的情况就是一个延迟加载的属性或者与JPA中涉及到关联关系的时候. 当验证这两种情况的属性的时候, 很可能会触发一次对数据库的查询.Bean Validation正是通过<code class="classname">TraversableResolver</code>接口来控制能否访问某一个属性的 (<a class="xref" href="validator-bootstrapping.html#example-traversable-resolver" title="例 5.8. TraversableResolver接口">例 5.8 “TraversableResolver接口”</a>).</p><div class="example"><a id="example-traversable-resolver"/><p class="title"><b>例 5.8. TraversableResolver接口</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_javadoc_comment">/**</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;*&nbsp;Contract&nbsp;determining&nbsp;if&nbsp;a&nbsp;property&nbsp;can&nbsp;be&nbsp;accessed&nbsp;by&nbsp;the&nbsp;Bean&nbsp;Validation&nbsp;provider</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;*&nbsp;This&nbsp;contract&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;property&nbsp;that&nbsp;is&nbsp;being&nbsp;either&nbsp;validated&nbsp;or&nbsp;cascaded.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;*</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;*&nbsp;A&nbsp;traversable&nbsp;resolver&nbsp;implementation&nbsp;must&nbsp;be&nbsp;thread-safe.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;*</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;*/</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">TraversableResolver</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_javadoc_comment">/**</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Determine&nbsp;if&nbsp;the&nbsp;Bean&nbsp;Validation&nbsp;provider&nbsp;is&nbsp;allowed&nbsp;to&nbsp;reach&nbsp;the&nbsp;property&nbsp;state</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;traversableObject&nbsp;object&nbsp;hosting&nbsp;&lt;code&gt;traversableProperty&lt;/code&gt;&nbsp;or&nbsp;null&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;validateValue&nbsp;is&nbsp;called</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;traversableProperty&nbsp;the&nbsp;traversable&nbsp;property.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;rootBeanType&nbsp;type&nbsp;of&nbsp;the&nbsp;root&nbsp;object&nbsp;passed&nbsp;to&nbsp;the&nbsp;Validator.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;pathToTraversableObject&nbsp;path&nbsp;from&nbsp;the&nbsp;root&nbsp;object&nbsp;to</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;traversableObject&lt;/code&gt;</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(using&nbsp;the&nbsp;path&nbsp;specification&nbsp;defined&nbsp;by&nbsp;Bean&nbsp;Validator).</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;elementType&nbsp;either&nbsp;&lt;code&gt;FIELD&lt;/code&gt;&nbsp;or&nbsp;&lt;code&gt;METHOD&lt;/code&gt;.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@return</span><span class="java_javadoc_comment">&nbsp;&lt;code&gt;true&lt;/code&gt;&nbsp;if&nbsp;the&nbsp;Bean&nbsp;Validation&nbsp;provider&nbsp;is&nbsp;allowed&nbsp;to</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reach&nbsp;the&nbsp;property&nbsp;state,&nbsp;&lt;code&gt;false&lt;/code&gt;&nbsp;otherwise.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isReachable</span><span class="java_separator">(</span><span class="java_type">Object</span><span class="java_plain">&nbsp;traversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Path</span><span class="java_separator">.</span><span class="java_type">Node</span><span class="java_plain">&nbsp;traversableProperty</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;rootBeanType</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Path</span><span class="java_plain">&nbsp;pathToTraversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ElementType</span><span class="java_plain">&nbsp;elementType</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_javadoc_comment">/**</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Determine&nbsp;if&nbsp;the&nbsp;Bean&nbsp;Validation&nbsp;provider&nbsp;is&nbsp;allowed&nbsp;to&nbsp;cascade&nbsp;validation&nbsp;on</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;bean&nbsp;instance&nbsp;returned&nbsp;by&nbsp;the&nbsp;property&nbsp;value</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;marked&nbsp;as&nbsp;&lt;code&gt;</span><span class="java_javadoc_tag">@Valid</span><span class="java_javadoc_comment">&lt;/code&gt;.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Note&nbsp;that&nbsp;this&nbsp;method&nbsp;is&nbsp;called&nbsp;only&nbsp;if&nbsp;isReachable&nbsp;returns&nbsp;true&nbsp;for&nbsp;the&nbsp;same&nbsp;set&nbsp;of</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;arguments&nbsp;and&nbsp;if&nbsp;the&nbsp;property&nbsp;is&nbsp;marked&nbsp;as&nbsp;&lt;code&gt;</span><span class="java_javadoc_tag">@Valid</span><span class="java_javadoc_comment">&lt;/code&gt;</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;traversableObject&nbsp;object&nbsp;hosting&nbsp;&lt;code&gt;traversableProperty&lt;/code&gt;&nbsp;or&nbsp;null</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;validateValue&nbsp;is&nbsp;called</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;traversableProperty&nbsp;the&nbsp;traversable&nbsp;property.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;rootBeanType&nbsp;type&nbsp;of&nbsp;the&nbsp;root&nbsp;object&nbsp;passed&nbsp;to&nbsp;the&nbsp;Validator.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;pathToTraversableObject&nbsp;path&nbsp;from&nbsp;the&nbsp;root&nbsp;object&nbsp;to</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;code&gt;traversableObject&lt;/code&gt;</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(using&nbsp;the&nbsp;path&nbsp;specification&nbsp;defined&nbsp;by&nbsp;Bean&nbsp;Validator).</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;elementType&nbsp;either&nbsp;&lt;code&gt;FIELD&lt;/code&gt;&nbsp;or&nbsp;&lt;code&gt;METHOD&lt;/code&gt;.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@return</span><span class="java_javadoc_comment">&nbsp;&lt;code&gt;true&lt;/code&gt;&nbsp;if&nbsp;the&nbsp;Bean&nbsp;Validation&nbsp;provider&nbsp;is&nbsp;allowed&nbsp;to</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cascade&nbsp;validation,&nbsp;&lt;code&gt;false&lt;/code&gt;&nbsp;otherwise.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isCascadable</span><span class="java_separator">(</span><span class="java_type">Object</span><span class="java_plain">&nbsp;traversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Path</span><span class="java_separator">.</span><span class="java_type">Node</span><span class="java_plain">&nbsp;traversableProperty</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;rootBeanType</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Path</span><span class="java_plain">&nbsp;pathToTraversableObject</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ElementType</span><span class="java_plain">&nbsp;elementType</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span>
</pre></div></div><br class="example-break"/><p>Hibernate Validator provides two <code class="classname">TraversableResolver</code>s out of the box which will be enabled automatically depending on your environment. The first is the <code class="classname">DefaultTraversableResolver</code> which will always return true for <code class="methodname">isReachable()</code> and <code class="methodname">isTraversable()</code>. The second is the <code class="classname">JPATraversableResolver</code> which gets enabled when Hibernate Validator gets used in combination with JPA 2. In case you have to provide your own resolver you can do so again using the <code class="classname">Configuration</code> object as seen in <a class="xref" href="validator-bootstrapping.html#example-traversable-resolver-config" title="例 5.9. 自定义的TraversableResolver">例 5.9 “自定义的TraversableResolver”</a>.</p><div class="example"><a id="example-traversable-resolver-config"/><p class="title"><b>例 5.9. 自定义的TraversableResolver</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_operator">&lt;?&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;configuration&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">configure</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;factory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;configuration</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">traversableResolver</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">MyTraversableResolver</span><span class="java_separator">())</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
</pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e2462"/>5.5. <code class="classname">ConstraintValidatorFactory</code></h2></div></div></div><p>最后, 还有个配置项得提一下, 那就是<code class="classname">ConstraintValidatorFactory</code>类. Hibernate Validator中默认的<code class="classname">ConstraintValidatorFactory</code>需要一个无参的构造方法来初始化<code class="classname">ConstraintValidator</code>的实例(参考<a class="xref" href="validator-customconstraints.html#section-constraint-validator">第 3.1.2 节 “约束校验器”</a>). 对于自定义的<code class="classname">ConstraintValidatorFactory</code>实现来说, 例如, 你可以让其支持对约束条件的依赖注入等功能. 配置使用这个自定义的<code class="classname">ConstraintValidatorFactory</code>的方法还是老样子(<a class="xref" href="validator-bootstrapping.html#example-constraint-validator-factory" title="例 5.10. 自定义的ConstraintValidatorFactory">例 5.10 “自定义的ConstraintValidatorFactory”</a>).</p><div class="example"><a id="example-constraint-validator-factory"/><p class="title"><b>例 5.10. 自定义的ConstraintValidatorFactory</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Configuration</span><!-- <br/> --><span class="java_operator">&lt;?&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;configuration&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">byDefaultProvider</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">configure</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;factory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;configuration</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">constraintValidatorFactory</span><span class="java_separator">(</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">IOCConstraintValidatorFactory</span><span class="java_separator">())</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">buildValidatorFactory</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
</pre></div></div><br class="example-break"/><p>你需要实现此接口:</p><div class="example"><a id="d0e2494"/><p class="title"><b>例 5.11. ConstraintValidatorFactory接口</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">interface</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">ConstraintValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_javadoc_comment">/**</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@param</span><span class="java_javadoc_comment">&nbsp;key&nbsp;The&nbsp;class&nbsp;of&nbsp;the&nbsp;constraint&nbsp;validator&nbsp;to&nbsp;instantiate.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;</span><span class="java_javadoc_tag">@return</span><span class="java_javadoc_comment">&nbsp;A&nbsp;constraint&nbsp;validator&nbsp;instance&nbsp;of&nbsp;the&nbsp;specified&nbsp;class.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">&lt;</span><span class="java_plain">T&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">ConstraintValidator</span><span class="java_operator">&lt;?</span><span class="java_separator">,</span><span class="java_operator">?&gt;&gt;</span><span class="java_plain">&nbsp;T&nbsp;getInstance</span><span class="java_separator">(</span><span class="java_type">Class</span><span class="java_operator">&lt;</span><span class="java_plain">T</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;key</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span>
</pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>如果一个约束条件的实现需要依赖<code class="classname">ConstraintValidatorFactory</code>的某个特定的行为(例如依赖注入或者没有无参的构造方法等) 都可能导致不可移植.</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>ConstraintValidatorFactory不应该缓存其创建的实例, 因为每个实例都可能在其的初始化方法中被修改.</p></div></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">版权 © 2009 - 2011 Red Hat, Inc. &amp; Gunnar Morling</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="validator-xmlconfiguration.html"><strong>上一页</strong>第 4 章 XML configuration</a></li><li class="up"><a accesskey="u" href="#"><strong>上一级</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>起始页</strong></a></li><li class="next"><a accesskey="n" href="validator-metadata-api.html"><strong>下一页</strong>第 6 章 Metadata API</a></li></ul></body></html>