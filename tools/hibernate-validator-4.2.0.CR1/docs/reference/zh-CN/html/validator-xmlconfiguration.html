<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">第 4 章 XML configuration</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="Hibernate Validator"/><link rel="up" href="index.html" title="Hibernate Validator"/><link rel="prev" href="validator-customconstraints.html" title="第 3 章 创建自己的约束规则"/><link rel="next" href="validator-bootstrapping.html" title="第 5 章 Bootstrapping"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="validator-customconstraints.html"><strong>上一页</strong></a></li><li class="next"><a accesskey="n" href="validator-bootstrapping.html"><strong>下一页</strong></a></li></ul><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-xmlconfiguration"/>第 4 章 XML configuration</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="validator-xmlconfiguration.html#d0e1980">4.1. validation.xml</a></span></dt><dt><span class="section"><a href="validator-xmlconfiguration.html#d0e2069">4.2. 映射约束</a></span></dt></dl></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1980"/>4.1. <code class="filename">validation.xml</code></h2></div></div></div><p>我们可以使用<code class="filename">validation.xml</code>来对Hibernate Validator进行配置. <code class="classname">ValidationFactory</code>在初始化的时候会在类路径下寻找此文件,如果找到的话,就会应用其中定义的配置信息. <a class="xref" href="validator-xmlconfiguration.html#image-validation-configuration" title="例 4.1. validation-configuration-1.0.xsd">例 4.1 “validation-configuration-1.0.xsd”</a>显示了<code class="filename">valiation.xml</code>的xsd模型.</p><div class="example"><a id="image-validation-configuration"/><p class="title"><b>例 4.1. validation-configuration-1.0.xsd</b></p><div class="example-contents"><div class="mediaobject"><img src="validation-configuration-1.0.png"/></div></div></div><p><br class="example-break"/></p><p><a class="xref" href="validator-xmlconfiguration.html#example-validation-xml" title="例 4.2. validation.xml">例 4.2 “validation.xml”</a> 列出了<code class="filename">validation.xml</code>中的一些常用的配置项.</p><div class="example"><a id="example-validation-xml"/><p class="title"><b>例 4.2. validation.xml</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">validation-config</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/configuration&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns:xsi</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xsi:schemaLocation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/configuration&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">default-provider</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.validator.HibernateValidator</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">default-provider</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">message-interpolator</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.validator.messageinterpolation.ResourceBundleMessageInterpolator</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">message-interpolator</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">traversable-resolver</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.validator.engine.resolver.DefaultTraversableResolver</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">traversable-resolver</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-validator-factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.validator.engine.ConstraintValidatorFactoryImpl</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-validator-factory</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">/constraints-car.xml</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-mapping</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;prop1&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">value1</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">property</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;prop2&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">value2</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">property</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">validation-config</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>类路径下面只能有一个<code class="filename">validation.xml</code>, 如果超过一个的话,会抛出异常.</p></div><p><code class="filename">validation.xml</code>中所有的配置信息都是可选的, <a class="xref" href="validator-xmlconfiguration.html#example-validation-xml" title="例 4.2. validation.xml">例 4.2 “validation.xml”</a>中就是列出了Hibernate Validator中的默认值. 如果类路径当中存在有多个Bean Validation的实现的话, 那么可以通过<span class="property">default-provider</span>节点指定使用那个Bean Validation的实现. <span class="property">message-interpolator</span>, <span class="property">traversable-resolver</span> 和 <span class="property">constraint-validator-factory</span>可以用来指定自定义的<code class="classname">javax.validation.MessageInterpolator</code>, <code class="classname">javax.validation.TraversableResolver</code>和<code class="classname">javax.validation.ConstraintValidatorFactory</code>. 同样的, 这些配置信息也可以通过编程的方式调用<code class="classname">javax.validation.Configuration</code>来实现. 另外, 你可以通过API的方式来重写xml中的配置信息, 也可以通过调用<code class="methodname"> Configuration.ignoreXmlConfiguration()</code>来完全的忽略掉xml的配置信息. 请参考<a class="xref" href="validator-bootstrapping.html" title="第 5 章 Bootstrapping">第 5 章 <i>Bootstrapping</i></a>.</p><p>你可以增加若干个<span class="property">constraint-mapping</span>节点,在每个里面列出一个额外的xml文件用来定义约束规则, 具体请参考<a class="xref" href="validator-xmlconfiguration.html#section-mapping-constraints">第 4.2 节 “映射约束”</a>.</p><p>Last but not least, you can specify provider specific properties via the <span class="property">property</span> nodes.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="d0e2069"/>4.2. 映射约束</h2></div></div></div><p>我们也可以通过xml来定义约束条件, 只需要这个xml符合<a class="xref" href="validator-xmlconfiguration.html#image-mapping-configuration" title="例 4.3. validation-mapping-1.0.xsd">例 4.3 “validation-mapping-1.0.xsd”</a>中所定义的规范. 需要注意的是, 你必须把xml定义的约束列在<code class="filename">validation.xml</code>的<span class="property">constraint-mapping</span>节点中才能得到处理.</p><div class="example"><a id="image-mapping-configuration"/><p class="title"><b>例 4.3. validation-mapping-1.0.xsd</b></p><div class="example-contents"><div class="mediaobject"><img src="validation-mapping-1.0.png"/></div></div></div><br class="example-break"/><p><a class="xref" href="validator-xmlconfiguration.html#example-constraints-car" title="例 4.4. constraints-car.xml">例 4.4 “constraints-car.xml”</a> 显示了如何通过xml定义的方式来给<a class="xref" href="validator-usingvalidator.html#example-car" title="例 2.15. Car">例 2.15 “Car”</a>中的类Car 以及<a class="xref" href="validator-usingvalidator.html#example-rental-car" title="例 2.19. RentalCar with @GroupSequence">例 2.19 “RentalCar with @GroupSequence”</a> 中的RentalCar定义约束条件.</p><div class="example"><a id="example-constraints-car"/><p class="title"><b>例 4.4. constraints-car.xml</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-mappings</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">xmlns:xsi</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xsi:schemaLocation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/mapping&nbsp;validation-mapping-1.0.xsd&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_attribute_name">xmlns</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;http://jboss.org/xml/ns/javax/validation/mapping&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">default-package</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.hibernate.validator.quickstart</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">default-package</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bean</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Car&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;manufacturer&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.NotNull&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;licensePlate&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.NotNull&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;seatCount&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.Min&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;value&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">2</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">field</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;driver&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">valid</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">field</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">getter</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;passedVehicleInspection&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;javax.validation.constraints.AssertTrue&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">message</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">The&nbsp;car&nbsp;has&nbsp;to&nbsp;pass&nbsp;the&nbsp;vehicle&nbsp;inspection&nbsp;first</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">message</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">groups</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">CarChecks</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">groups</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">element</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;max&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">10</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">element</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">getter</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">bean</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">class</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;RentalCar&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">class</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">ignore-annotations</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">group-sequence</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">RentalCar</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">CarChecks</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">group-sequence</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">class</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">bean</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">constraint-definition</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">annotation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.mycompany.CheckCase&quot;</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">include-existing-validator</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">validated-by</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">include-existing-validators</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain">org.mycompany.CheckCaseValidator</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">value</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">validated-by</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-definition</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">constraint-mappings</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><p>这个xml的定义基本上和通过编程方式差不多, 所以只需要简单的解释. 其中<span class="property">default-package</span>属性用来定义一个默认的包路径, 如果下面指定的class不是全限定名称的话,会自动加上这个默认的包路径. 每个xml文件都可以包含任意多个<span class="property">bean</span>节点, 每个对应一个要添加约束条件的实体类.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>每个实体类只能在所有的xml映射文件中被定义一次, 否则会抛出异常.</p></div><p> 通过添加<span class="property">ignore-annotations</span> 属性并将其设置为<code class="constant">true</code>可以忽略在对应<span class="property">bean</span>上添加的约束标注信息, 这个属性的默认值就是<code class="constant">true</code>. <span class="property">ignore-annotations</span> 属性还可以定义在<span class="property">class</span>, <span class="property">fields</span> 和 <span class="property">getter</span>属性上, 如果没有明确指定的话, 那么默认级别是<span class="property">bean</span> (可参考 <a class="xref" href="validator-usingvalidator.html#validator-usingvalidator-annotate" title="2.1. 定义约束">第 2.1 节 “定义约束”</a>).  <span class="property">constraint</span> 节点用于添加一个约束条件到其父节点对应的元素上, 并且它需要通过<span class="property">annotation</span>属性来指定需要使用哪个约束条件. 对于每个约束条件中所需要的属性, 其中, 由Bean Validation 规范规定的属性(<span class="property">message</span>, <span class="property">groups</span> 和 <span class="property">payload</span>) 可以通过同名的子节点来定义, 而每个约束条件中自定义的属性, 则需要使用<span class="property">element</span>节点来定义.</p><p><span class="property">class</span>节点同样支持通过<span class="property">group-sequence</span>节点来对一个类的默认校验组进行重定义(请参考 <a class="xref" href="validator-usingvalidator.html#section-default-group-class" title="2.3.2. 对一个类重定义其默认校验组">第 2.3.2 节 “对一个类重定义其默认校验组”</a>) .</p><p>最后, 你还可以通过<span class="property">constraint-definition</span>节点来对一个指定的约束条件上绑定的校验器(<code class="classname">ConstraintValidator</code>)进行修改. 此节点上的<span class="property">annotation</span>对应要修改的约束条件, 而<span class="property">validated-by</span>子节点中(按顺序)列出要关联到此约束条件上的校验器( <code class="classname">ConstraintValidator</code>的实现类), 而<span class="property">include-existing-validator</span>属性如果是<code class="constant">false</code>的话,那么默认定义在此约束条件上的校验器将被忽略, 如果为<code class="constant">true</code>, 那么在xml中定义的校验器会被添加在约束条件上默认定义的校验器的后面.</p></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">版权 © 2009 - 2011 Red Hat, Inc. &amp; Gunnar Morling</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="validator-customconstraints.html"><strong>上一页</strong>第 3 章 创建自己的约束规则</a></li><li class="up"><a accesskey="u" href="#"><strong>上一级</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>起始页</strong></a></li><li class="next"><a accesskey="n" href="validator-bootstrapping.html"><strong>下一页</strong>第 5 章 Bootstrapping</a></li></ul></body></html>